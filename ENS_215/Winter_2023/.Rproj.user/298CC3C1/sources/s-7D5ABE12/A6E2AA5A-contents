---
title: 'Lab 2: Global Dams Data'
author: "Katie Boermeester"
output:
  html_document:
    df_print: paged
---

## Introduction
Dams are something often debated by environmentalists in terms of being sustainable and worthwhile based on the technology and funds required, alongside the massive environmental disturbance that often comes with the construction of dams. Even with that in mind, humans have relied on dams in numerous ways, including but not limited to, flood control, water supply, navigation, and irrigation. The construction of dams, at least within this data set, goes as far back as 1000. Humans are very familiar with dams, alongside the many negative impacts that follow. Even with that in mind, there is still a reliance on these structures and a major need for the technology and engineering of these dams to, at the minimum, reduce the environmental and societal impacts and still provide the optimal results needed by the human race
Within this study of dams, we will be viewing dams within several regions to view their location, size, and functionality and visualizing the importance of these dams within their given  regions. One goal of this lab is to focus into one region in particular and view its respective dams, seeing if there is a trend in terms of size, functionality, or any other variables that can be visualized. Wtihin this lab we will be using data from the United Nations Food and Agricultural Organization (FAO) to gain this insight and reach that previously stated goal. 

## Section 1: Examination of Data
```{r}
library(tidyverse)

dams_data <- read_csv("http://stahlm.github.io/ENS_215/Data/Dams_FAO_SelectCols_LabData.csv")
```
```{r}
head(dams_data)
tail(dams_data)
summary(dams_data)
```
Viewing this data set, there are 14216 observations of 22 different variables. The key variables include different dam names, alongside their country of origin, capacity, sediment percentage, and other functionality items beginning with "Irrigation" and up until "Other". Alongside those variables, the continent, latitude, and longitude are available as well so that we may be able to make various observations from the data set. With the head() and tail() functions, the first set of data comes from Algeria while the last set comes from Vietnam. Multiple countries have multiple dams, thus why there are so many entries. 

```{r fig.width=4, fig.height=3}
ggplot(data=dams_data) +
  geom_point(aes(x=Reservoir_capacity_million_m3, y=Reservoir_area_km2, color=Continent), na.rm=TRUE)
```
Before adding "na.rm = TRUE" to the code, there was 4234 rows that were removed due to being NA values. Even with the addition of the code to remove those values, the data removes those values automatically. There is a clear area of focus, which lies in the range of 0-25000 million m^3 of capacity and having an area less than 10,000km^2. There are quite a few outlier points, including some that are greater than 150,000 million m^3 in capacity and 50,000km^2 of capacity respectively. I colored the points to veiw the range bewteen dams of different continents, but due to the majority of the data lying in a corner of the plot, there isn't much of an observation that can be made. 

```{r fig.width=4, fig.height=3}
ggplot(data=dams_data) +
  geom_point(aes(x=Reservoir_capacity_million_m3, y=Reservoir_area_km2, color=Continent), na.rm=TRUE) +
  scale_x_log10()+
  scale_y_log10()
```
The graph above is the same plot as previously, except with a logarithmic scale. It is clear that there are a ton of dams within the continent of Asia, though the dams within the Americas seem to ahve the greatest range of areas and capacities. There is a set of Asian dams that lie outside of the large "blob" of points, which have a lower area but a large capacity, which would lead me to believe that there those dams are used for watersupply, flood control, or potentially pollution control. 

```{r}
filter(dams_data, Reservoir_capacity_million_m3 > 125000)
```
```{r}
filter(dams_data, Reservoir_area_km2 >40000)
```
The tables above grabbed the dams that are the key outliers from the original scatter plot created. There is not much of a correlation between larger dams (whether speaking about capacity or area) and developed/developing countries. What I think is a key observation or possibility of why these dams are so large is to accommodate for larger populations and yet are being underutilized or are being wasted due to their high surface area allowing for evaporation or the capacity allowing for larger build-ups of sedimentation and contamination. 

```{r fig.width=4, fig.height=3}
ggplot(data=dams_data) +
  geom_point(aes(x=Reservoir_capacity_million_m3, y=Dam_height_m, color=Continent), na.rm=TRUE)
```
There isn't much of a trend in terms of dam height and capacity, though there are dams with heights ~200 m that have little to no capacity. Table below that filters by a couple of values helps visualize this. A majority of the dams in that range are from Asia, and two of the interesting outliers having heights greater than 600 m an having no storage.

```{r}
filter(dams_data, Reservoir_capacity_million_m3 <25000, Dam_height_m <300)
```

```{r}
filter(dams_data, Reservoir_capacity_million_m3 <25000, Continent == "Asia")
```
From the 11,101 dams that are included in the area with minimal capacity, 6,143 of those dams are Asian dams. This trend might ahve something to do with the dam's function focusing into transportation, flood control (directional-wise), recreation, livestock-rearing, etc. 

```{r}
filter(dams_data, Continent == "Asia", Dam_height_m >600)
```
Jacob asked me to grab the two outliers within Asia that had dam heights greater than 600 m, which are the Talimarjana nd Lakba dams in Uzbekistan and Georgia respectively. These dams  are primarily used for irrigation purposes, though I would not doubt that they have secondary functions due to still being used ~30 years later. We also looked at the Lakbe dam in particular, which is mostly wrong. We were assuming it might be measured in feet instead of meters, which may account for the error. 

```{r}
filter(dams_data, Dam_name == "Nurek") 
```
We also grabbed Nurek, which is supposedly one of the tallest dams, and it is not even one of the top ten, thus why we thought the dataset has at least a few errors. 
```{r fig.width=4, fig.height=3}
ggplot(data=dams_data) +
  geom_point(aes(x=Reservoir_capacity_million_m3, y=Dam_height_m, color=Continent), na.rm=TRUE) +
  scale_x_log10()+
  scale_y_log10()
```
The logarithmic graph has a similar trend to the other logarithmic graph created looking at reservoir capacity and area. There is a position correlation between capacity and dam height. Most of the American dams that lie behind the larger Asian-covered area have lower capacities and dam heights, suggesting alternative functions including pollution control and recreation. 

```{r}
dams_data %>%
  group_by(Continent) %>% 
  summarize(mean_height = mean(Dam_height_m, na.rm = TRUE), mean_area = mean(Reservoir_area_km2, na.rm=TRUE), mean_storage = (mean(Dam_height_m, na.rm = TRUE)))

```
From the averages that we got, we are now able to compare the storage, height, and area data to make observations about the data recieved. The largest value is contained in Africa with a mean area of 223.86 km^2, most likely due to their dams acting primarily as forms of irrigation within agriculture and livestock rearing. Meanwhile, the continent having the tallest dams on average is Europe. This could be attributed to water supply, transportation, or flood control. And the largest average in term sof storage is in Europe as well, which can easily be attributed to the functions said in the previous statement. 
```{r fig.width=4, fig.height=3}
dams_data %>% 
ggplot(aes(x=Continent, y=Reservoir_capacity_million_m3, color=Continent)) +
  geom_boxplot() +
  scale_y_log10()
```
The distributions have their differences. The continents that have the most similar dispersion are the Americas and Asia, meanwhile Oceania and Europe have a somewhat similar distribution. That being said, they are only similar in the fact that their 25th and 75th percentiles are fairly small. Africa nad Europe are fairly similar in terms of having most of their outliers remaining above the median, whereas the Americas, Asia, and Oceania have their outliers distributed across both sides of the median. 

## Section 2: Additional Analysis & Discussion

```{r}
arrange(dams_data, Year_completed)

```
Based on the table above, I wanted to view the functionality of certain dams created. My assumption is that most of these dams were used for agricultural and transportation (recreational) purposes. Alongside this, I would like to see if there is a trend in terms of certain continents having certain functions/purposes for these dams. The table above also shows the time-scale of dams created, beginning at the year 1000. I saw within another plot that the year 1000 is an outlier, though completely factual in terms of its creation and functionality in India. The table below factors out any dams created prior to 1250 and beyond 1900. 
```{r}
dams_data %>% 
  filter(Year_completed < 1900, Year_completed > 1250) %>% 
  arrange(Year_completed)
```
Included in this table are the years 1470 to 1899, still giving a decent range in terms of data to take a further look at. Based on the boxplot below, it can be seen that Africa, Europe, Oceania regions have the least amount of dams. A majority of these dams, based on the median, 25th and 75th percentile, were built between 1925 and 2000. A majority of the outlying points are preceding 1950. This plot does ignore dates prior to 1500 due to the fact that the boxes, which are already very small, were not able to be differentiated or analyzed by the naked eye. Having 1500 as the cutoff year for this plot allows the data to be seen as best as possible. 
```{r}
dams_data %>% 
ggplot(aes(x=Continent, y=Year_completed, color=Continent)) +
  geom_boxplot() +
  coord_cartesian(ylim=c(1500, NA))
  
```
```{r}
dams_data %>% 
  filter(Continent %in% c("Oceania"), Year_completed < 1900) %>% 
  arrange(Year_completed)
```
Above I have created a table containing the data for Oceania, the region with the lowest amount of dams. Again, I have filtered the data to include dams created prior to 1900. From the table, all of the dames were created between 1857 and 1898, which is fairly recent in comparison to other data that was previously filtered. With that, all but one dam is located within Australia. All are connected to some sort of water body, and with that, are relatively large in size with the exception on the New Zealand dam. 

```{r}
dams_data %>% 
  filter(Continent %in% c("Oceania"), Year_completed < 1900) %>% 
  summarize(sum_Irrigation = sum(Irrigation), 
            sum_WaterSupply = sum(Water_supply), 
            sum_FloodControl = sum(Flood_control), 
            sum_Hydroelectricity = sum(Hydroelectricity), 
            sum_Navigation = sum(Navigation), 
            sum_Recreation = sum(Recreation), 
            sum_PollutionControl = sum(Pollution_control), 
            sum_LivestockRearing = sum(Livestock_rearing), 
            sum_Other = sum(Other)) 
  
```
From summing the functions of the dams in the Oceania region, they seem to all be used to manage the water supply. Knowing this information now, I'm curious to see where these dams are placed within Australia and New Zealand in terms of their dispersal on a relatively dry terrain. I do believe that the New Zealand data may have a few errors, due to the fact that having a 0.1 m^3 capacity and area is highly unlikely if the dam is being used to hold/transport water across the country. After exploring and coming upon "Engineering New Zealand" (https://www.engineeringnz.org/programmes/heritage/heritage-register/karori-water-supply-dams-and-reservoirs/), there are several observations that can be made alongside with the idea that no two dams are alike. 
This website, though not focusing on the numbers of the dam (in terms of area, height, and capacity), explains that the dam isn't meant to fit the stereotypical dam profile. The "Earth Dam" contains the Lower and Upper Karori, though the Lower Karori is the only piece available in this data set. The Lower Karori has a clay core, which was an infrastructure choice decided by engineer Nicholas Merchant due to the availability of materials. The concrete structure gave the inspiration to the construction of the Upper Karori, which was built due to the Lower Karori Dam not meeting the water supply demands of the country. In particular, the Lower Karori Dam supplied the capital city. I say "supplied" due to the fact that these dams were decommissioned due to earthquake concerns in the 1990s (https://d2rjvl4n5h2b61.cloudfront.net/media/documents/karori_water_supply_registerreport.pdf). Even with exploring these resources, I cannot confirm nor deny any numbers in regards to the capacity and area. It can be said though that the Karori Reservoir as a whole, was rudimentary to the basis of knowledge for the construction of future dams in New Zealand. Though the dam is decommissioned now, the legacy behind this dam is still acknowledged by New Zealand locals and worldwide engineers. 
Though I focused into New Zealand in particular within the data set, these dams are vital for the Oceania region to have water during the dry seasons, which was expressed within the previously referenced resources. The primary reason for the building of the Karori Reservoir was due to the shortage of water, and connecting this knowledge with the current terrain of Australia and the influence of climate change on the already-extreme conditions, it is safe to say that these dams are vital for the maintaining and sustainabiltiy of the region. I imagine, now seeing that there are potential errors, there have been numerous more dams added to the region for the sake of water supply. This does not mean that those dams have only a single purpose though. 

```{r}
dams_data %>% 
  filter(Continent=="Oceania")
```
```{r}
dams_data %>% 
  filter(Continent %in% c("Oceania")) %>% 
  summarize(sum_Irrigation = sum(Irrigation), 
            sum_WaterSupply = sum(Water_supply), 
            sum_FloodControl = sum(Flood_control), 
            sum_Hydroelectricity = sum(Hydroelectricity), 
            sum_Navigation = sum(Navigation), 
            sum_Recreation = sum(Recreation), 
            sum_PollutionControl = sum(Pollution_control), 
            sum_LivestockRearing = sum(Livestock_rearing), 
            sum_Other = sum(Other)) 
```
As assumed earlier, after looking at all the data for the Oceania region, there are many more dams within the region that do not necessarily focus into water supply. That being said, water supply is still the primary function of these dams, but it is trailed by hydroelectricity and thereafter recreational purposes. As the region has become more industrialized, it is not surprising that the usage of dams has expanded into electricity and tourism. I am surprised that there are not more dams focused into flood control due to the previous worry involving earthquakes. Much of the region is attached to the Ring of Fire, or rather a very active plate boundary fully capable of producing large-scale earthquakes within that longitude of the world (speaking about Japan in particular). I wonder if there will be more construction focusing into not only flood control, but also pollution control as the influence of climate change alongside environmental contaminants (i.e. plastics, pesticides, carbon, etc.) becomes a more prominent concern. 

##Conclusion
Based on the analysis of dams not only in the Oceania region, but across the world, there are many correlations in regards to dam size, height, and capacity in conjunction with its primary function. Although for the additional analysis, I did not focus on those correlations, but rather the primary function of Oceania dams, it can be seen that these dams are required to maintain the water supply and sustainability of society within that region. With a drier region that is more progressive in terms of its technological advances, there is no surprise that there are many dams focused into hydroelectricity and water supply. If there was a way I could expand on this, it would have been to create a histogram showing the progression of dams and their functions as we approached the 21st century. The only dams in Oceania prior to 1900 were used for water supply. Seeing the shifting of focus stray from water supply as the region became more industrialized would be very interesting. I am sure there could be a bar graph or histogram I would be able to execute with the data I have, but I believe I am asking more than I am capable of,thus why I believe this could be a future endeavor that I would be able to knock out of the park once I have honed by skilled with R. Besides this, some future directions with this data, not only some small corrections, but also to go further in depth in terms of the history of various regions and exploring the purpose of these dams. Dams, though they have beneficial functions, come with a large price tag in terms of money and environmental impact. I am curious to see if certain regions evaluated these tags when they first built these dams, thus why I think looking into the history specifically can give more insight than simply looking at numerical data. 
