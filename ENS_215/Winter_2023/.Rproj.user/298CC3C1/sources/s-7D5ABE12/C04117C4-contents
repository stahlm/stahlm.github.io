---
title: "Lab 01 ENS-215 Fuel Economy Analysis"
author: "Noah Pittman"
date: "2023-01-09"
output:
  html_document:
    toc: yes
    df_print: paged
  html_notebook:
    df_print: paged
    theme: spacelab
    toc: yes
---
## Loading in librarys 
```{r}
library("ggplot2")
```

```{r}
library(tidyverse)
library(stats)

dams_data <- read_csv("https://stahlm.github.io/ENS_215/Data/Dams_FAO_SelectCols_LabData.csv")
```
<br/>
<br/>
<br/>
```{r}
head(dams_data)
summary(dams_data)
view(dams_data)
```
<br/>
<br/>


### 1) Creating a Scatter plot showing the relationship between resevoir storage and resevoir area

#### Answers to Questions

+ An interesting feature I noticed is that there are many high capacity dams that minimize surface area


```{r}
ggplot(data= dams_data) + geom_point(aes(x= Reservoir_capacity_million_m3, y= Reservoir_area_km2))+scale_x_log10()+scale_y_log10()
```

<br/>
<br/>


### 2) Creating a Scatter plot showing the relationship between resevoir storage and resevoir height

#### Answers to Questions

+ Most dams are very tall but don't hold much water

+ There are a few instances where there are a multitude of dams that have the same Y axis, height, and steadily increasing capacity. These may be dams that are along a river or in a valley where their height is limited, or they may be in countries that limit the height of its dams (installed ggplot2 to find this out and the answer is yes, there are specific countries who must regulate the height of their dams)

+ I color correlated the dam lines to test this argument but removed the legend because it consumed the entire graph


```{r}
#ggplot(data= dams_data) + geom_point(aes(x= Reservoir_capacity_million_m3, y= #Dam_height_m, color = ISO_code))+ theme(legend.position ==”none”)

ggplot(dams_data,aes(x=Reservoir_capacity_million_m3,y=Dam_height_m))+
geom_line(aes(color=Country))+
geom_point()+theme(legend.position="none")+ scale_x_log10()+scale_y_log10()

```

<br/>
<br/>


### 3) Height, area and storage averages

#### Answers to Questions

+ Interesting to see that Europe has the largest capacity dams on average but also that Africa has the second most average capacity. some continents are less moutainous than others

```{r}
## Failed attempt
#continents<-c(dams_data$Continent)
#print(continents)
#for(continent in continents){
  #continent_df<-filter(dams_data, continent)
  #h_avg<-mean(continent_df,height)
 # print(h_avg)
#}


dams_data %>% 
  group_by(Continent)%>%
  summarize(mean_height = mean(Dam_height_m, na.rm=TRUE), mean_area = mean(Reservoir_area_km2, na.rm=TRUE), mean_storage = mean(Reservoir_capacity_million_m3, na.rm=TRUE))
```

<br/>
<br/>

### 4) Box plot of distribution of reservoir storage capacities
#### Answers to Questions

+ Distributions are significantly different among countries, especially in Especially in Europe where there are the most dams

```{r}
ggplot(dams_data)+ geom_boxplot(aes(x= Continent, y= Reservoir_capacity_million_m3)) +
  scale_y_log10()
```

<br/>
<br/>

## Additional Analysis

### 1) Summary Table with additional info

```{r}
dams_data %>% 
  group_by(Major_basin)%>%
  summarize(mean_height = mean(Dam_height_m, na.rm=TRUE), mean_area = mean(Reservoir_area_km2, na.rm=TRUE), mean_storage = mean(Reservoir_capacity_million_m3, na.rm=TRUE), mean_irrigation =mean(Irrigation,na.rm=TRUE),mean_Water = mean(Water_supply,na.rm=TRUE),mean_sed = mean(Sedimentation_percent,na.ra=TRUE))
```

<br/>
<br/>

### 2) Mean

```{r}
dams_count<-dams_data%>%group_by(Year_completed)%>%summarize(the_count=length(Year_completed))
dams_count

```

```{r}
dams_count<- dams_count%>%arrange(Year_completed)%>%
  mutate(Total_dams=cumsum(the_count))
dams_count
```

### Total number of dams over time

```{r}

ggplot(dams_count)+ geom_point(aes(x= Year_completed, y= Total_dams)) + geom_line(aes(x=Year_completed,y=Total_dams))+
 scale_y_log10()
```

<br/>
<br/>

### 3) Selection of country

```{r}
china_dams<-filter(dams_data,Country=="China")
china_dams

```

<br/>
<br/>

### 4) china_dams examination

```{r}
## Failed Appempt

#dams_list<-c()
#china_dams%>% mutate(case_when(Irrigation==1 ~ "Irrigation"),case_when(Water_supply==1~ "Water Supply"),case_when(Hydroelectricity==1~"Hydro Power"),case_when(Flood_control==1~"Flood Control"),case_when(Other==1~"Other Purpose"),case_when(Livestock_rearing==1~"Livestock"),case_when(Navigation==1~"Navigation"),case_when(Pollution_control==1~"Pollution Control"),case_when(Recreation==1~"Recreation"),na.nr=TRUE)

## Working code that seperates the purpose of each dam into one column

dams_list<-c()
china_dams <- china_dams%>% mutate(Year_completed,Purpose=case_when(Irrigation==1 ~ "Irrigation",Water_supply==1~ "Water Supply",Hydroelectricity==1~"Hydro Power",Flood_control==1~"Flood Control",Other==1~"Other Purpose",Livestock_rearing==1~"Livestock",Navigation==1~"Navigation",Pollution_control==1~"Pollution Control",Recreation==1~"Recreation"),na.rm=TRUE)


## Failed attempt


#purposes_df<-china_dams%>%group_by(Dam_name,Year_completed,Ir#rigation,Water_supply,Flood_control,Hydroelectricity,Navigati#on,Recreation,Pollution_control,Livestock_rearing,Other)%>%
  
#  mutate(Year_completed,Dam_name, #Irrigation==1,Water_supply==1,Flood_control==1,Hydroelectrici#ty==1,Navigation==1,Recreation==1,Pollution_control==1,Livest#ock_rearing==1,Other==1)






```

### Box plot of the purpose for each dam and the completed year

```{r}
ggplot(china_dams)+ geom_boxplot(aes(x= Purpose, y=Year_completed,)) +
  scale_y_log10()
```

### GEOM_POINT representation of the box plot above just for compairison

```{r}
ggplot(china_dams)+geom_point(aes(x=Purpose,y=Year_completed))
```

### When and where were the majoroty of dams built in china (by basin)

```{r}
ggplot(china_dams)+geom_point(aes(x=Year_completed,y=Major_basin,color = Major_basin))+ theme(legend.position = "none") 
```

### Is the height of the dam affected by its intended purpose?


```{r}
ggplot(china_dams)+geom_point(aes(x=Purpose,y=Dam_height_m))+ theme(legend.position = "none") 
```

### Does dam height change over time?

```{r}
ggplot(china_dams)+geom_point(aes(x=Year_completed,y=Dam_height_m))+ theme(legend.position = "none")+ geom_line(aes(x=Year_completed,y=Dam_height_m))
```





