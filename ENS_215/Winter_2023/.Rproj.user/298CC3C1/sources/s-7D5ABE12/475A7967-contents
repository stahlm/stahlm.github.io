---
title: "Global Dams Data and analysis"
author: "Ryan Nowak"
date: "01.16.2023"
output:
  html_document:
    theme: cerulean
    highlight: haddock
    df_print: paged
---
+ Introduction
+ Exercises
  + part 0
  + part 1
  + part 2
  + part 3
  + part 4
+ Additional Exercises
  + part 1
  + part 2
  + part 3
  + part 4
+ Conclusion


## Introduction:


For this lab we will be exploring data based on dams from around the world. This 
data contains more than 14000 observations and 22 variables ranging from country
to the uses such as pollution control. First we will examine the whole data set
before creating plots and tables to view the relationships between various variables.
This lab will allow us to understand the inital steps to creating plots that will
help us understand large data sets.


## Exercises


#### Part 0:

```{r}
# load in necessary packages and data
library(tidyverse)

dams_data <- read_csv("https://stahlm.github.io/ENS_215/Data/Dams_FAO_SelectCols_LabData.csv")

```
###### Becoming familiar with the data
```{r}
# run view in the console by itself first then -> head & summary
head(dams_data)
```

```{r}
summary(dams_data)
```


##### Observations:
This summary has taken all 14216 dams and for each of the variables described what type
of data each variable is such as, characters or numerics. Then it has taken the 
numerical variables and calculated the 6 key values for each one such as: Dam_height,
capacity, area, amount of sediment, the various uses, and the geolocation. Some of
the variables are lised as either a 1 or 0 which represents if that dam is utilized
for that variable or if it is not. The key variables in this data set are year completed, 
height, capacity, and area. However, there is a slight issue with the data because
it contains variables with missing data. This means that the summarized calculations
are not entirely accurate, but we can avoid running into errors by simply omitting
the na's.

```{r}
#would like to rearrange the data so we can see country, dam name, year built, river, resivoir capacity, then rest

dams_data_shifted <- select(dams_data,
                            Country,
                            Dam_name,
                            Year_completed,
                            River, 
                            Reservoir_capacity_million_m3,
                            everything())
```


#### Part 1


```{r}
# to plot the relationship between resivoir storage and area
ggplot(data = dams_data) +
  geom_point(aes (x = Reservoir_capacity_million_m3, y = Reservoir_area_km2, color = Continent)) + 
  scale_x_log10()+
  scale_y_log10()
```


##### Observations:
Generally this plot illustrates how as resivor capacity increases the area also
increases. This is true except for some of the outliers such as the values that 
seem to be y-intercepts. There is also a section in the middle f the plot that 
seems to be a straight line showing as capactiy increased area did not change for 
dams in Asia. The plot also is much easier to analyze when the axis are in log10.




#### Part 2


```{r}
# to plot the relationship between reservoir storage and dam height

ggplot(data = dams_data) +
  geom_point(aes (x = Reservoir_capacity_million_m3, y = Dam_height_m, color = Continent)) + 
  scale_x_log10()+
  scale_y_log10()
```


##### Observations:
This plot illustrates that the majority of the dams in the world are about the same
capacity and height, especially in Asia. However, in the Americas there seems to be
a much larger spread in capacity compared to height. This plot also has outliers that
seem to be y-interceptys which is strange.




#### Part 3


```{r}
#height per continent

dams_data %>%
  group_by(Continent) %>%
  summarise(avg_height = mean(Dam_height_m, na.rm = TRUE))
```


```{r}
#area per continent
dams_data %>% 
  group_by(Continent) %>% 
  summarise(avg_area = mean(Reservoir_area_km2, na.rm = TRUE))
```


```{r}
#storage averages by continent
dams_data %>% 
  group_by(Continent) %>% 
  summarise(avg_storage = mean(Reservoir_capacity_million_m3, na.rm = TRUE))
```


##### Observations:
Based on the above calculations it can be conclude that Europe has the highest dams 
and the greatest amount of storage per dam. However, African dams have the most 
area per dam. It can hypothesiszed that Europe may have the highest dams with the
most storage because of the topography of the land, and because the majority of 
these dams are very old. Europe has a long history of dams which are utilized for 
hydroelectricity, where African dams are used for irrigation and water storage.
Irrigation useage could account for why the dams have a much larger reseivor area,
yet not the highest amount of storage.





#### Part 4


```{r}
ggplot(data = dams_data) +
  geom_boxplot(aes (x = Continent, y = Reservoir_capacity_million_m3, color = Continent))+
  scale_y_log10()
```


##### Observations:

Based on this plot it could be concluded that generally dams across the world have
a generally similar capacity size. It seems like the Americas and Asia have the 
largest spread in size differences where European dams are generally larger than
the rest of the world.




## Additional analysis


#### Part 1


```{r}
#make a table with averages, mins and maxes of height, area per country
dams_data %>%
  group_by(Continent) %>% 
  summarise(avg_storage = mean(Reservoir_capacity_million_m3, na.rm = TRUE),
            avg_height = mean(Dam_height_m, na.rm = TRUE),
            avg_area = mean(Reservoir_area_km2, na.rm = TRUE),
            avg_year = mean(Year_completed, na.rm = TRUE))
```


##### Analysis:
For this first part I wanted to combine the calculated values in part 3 into one
table while also calculating the average year dams were built in each region.
To my suprise the region with the oldest dams was the Americas followed by Oceania.
Collecting the averges into one table is much easier for readers and helps when
comparing the regions to one another. 


#### Part 2
```{r}
#create a graphical representation of dams used for pollution
dams_for_pollution <- dams_data %>% filter(Pollution_control == 1)

ggplot(data = dams_for_pollution) +
  geom_boxplot(aes (x = Continent, y = Reservoir_capacity_million_m3, color = Continent))+
  scale_y_log10()
```


#### Part 3
```{r}
US_pollution_dams <- dams_for_pollution %>% filter(ISO_code == "USA")

US_pollution_dams %>% 
  select(Dam_name,
         Year_completed,
         Dam_height_m,
         Reservoir_area_km2, 
         Reservoir_capacity_million_m3) %>% 
  summary()
```


#### Part 4
```{r}
US_pollution_dams %>%
  select(Dam_name,
         Year_completed, 
         Dam_height_m, 
         Reservoir_area_km2,
         Reservoir_capacity_million_m3)
```


##### Conclusion
For the additional analysis section of this lab I decided for focus on the use of
dams in the US for pollution control (parts 2-4). I first created a graphical 
representation of the number of dams used around the world by their capacity. I 
found that Asia has the largest pollution control dams, and both Africa and Europe
have a much lower amount of dams used for pollution control. I then created a new 
data set for dams in the US that are used for pollution, followed by creating a 
summary of this data. Where I found that there are 50 dams in the US used for 
pollution with an average completed building year of 1931, with an average capacity
of about 156 million m^3, and an area of 8.8 km^2. Then I presented the data in a 
table so that I could see the individual names of each dam along with their individual 
sizes. Moving forward I would like to take this data and create a plotted map to 
see if the dams are clustered in any specific region of the US or is they are in
regions of heavy industrialization.
