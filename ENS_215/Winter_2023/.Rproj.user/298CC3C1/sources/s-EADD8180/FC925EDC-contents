

```{r}
library(tidyverse)
library(ggThemeAssist)
library(shiny)
dams_data <- read_csv("https://stahlm.github.io/ENS_215/Data/Dams_FAO_SelectCols_LabData.csv")
```

```{r}
summary(dams_data)
```

```{r}
select(dams_data)
```

```{r}
ggplot(data = dams_data) + geom_point(aes(x = Reservoir_capacity_million_m3, y = Reservoir_area_km2, color = Continent))
```
Do you notice any interesting features? Comment your observations.

**Looking at the figure I notice that a majority of the dams have a capacity below 50,000 million m^3 and a reservoir area under 10,000 km^2. However, there are outliers for both of these specific metrics as some dams exhibit a very great reservoir area over 50,000 km^2, while having a very small storage at less than 25,000 million m^3. While, these dams span a wide area it is likely that they are much shallower than the other dams containing the same range of capacity with a lower overall area.  Additionally I notice some dams have a great capacity within a small area.There are five different dams where capacity exceeds 1250000 million m^3 yet they have a reservoir area below 10000 km^2. These great capacity dams are likely much deeper than their counterparts allowing them to hold a greater quantity of water.  Looking at the graph I also noticed a concentration of dams in Asia which exhibit reservoir areas between 0 and 50,000 km^2 and a reservoir capacity between 0 and 25000 million m^3.  European and American dams on the otherhand typically observe a greater capacity than their Asian counterparts typically ranging between  0 and 75000 million m^3. I also noticed that dams with a lower level of area and high levels of capacity are more efficient as they result in less land being flooded and less overall environmental interruption.**
```{r}

dams_data %>%
  ggplot(aes(x = Dam_height_m, y = Reservoir_capacity_million_m3, color = Continent)) +
  geom_point() +
  
  scale_x_log10() +
  scale_y_log10() +
  
  facet_wrap(~Continent)
# facet_wrap(~continent) allows us to make separate graphs of dividing information by continent
```
Do you notice any interesting features? Comment on your observations

**When looking at the scatterplot containing variables of dam height and storage, I see that a majority of the dams fall between a height magnitude of 10 m and 100 m.Through looking at the data using the log_scale method we can see that Asian based dams observed a greater magnitude for height ranging between 10 m and 100 m in comparison to the Americas where a majority of dams fall between a magnitude of 1 m and 10 m. Looking at this figure I also notice that numerous American based dams despite having a lower dam height are able to achieve equal or even greater than levels of storage capacity than their Asian counterparts. Based on these two variables we can assume that the American dams are more effective at storing water than Asian dams as they are able to store just as much water without needing to construct the same height of dam. We can also infer that the American dams are also less resource costly, without information on dam length as taller dams require more structural support and materials to achieve the same heights.  Looking at the overall trend of this log_based scatterplot I am able to see that when you increase the magnitude of height for dams it typically results in a greater capacity of storage. On average the European built dams appear to achieve the greatest levels of storage on  average with many achieving a magnitude of storage over 1e+01.**

```{r}
dams_data %>%
  group_by(Continent) %>% 
  summarize(mean_height = mean(Dam_height_m, na.rm = T),
            mean_reservoir_area = mean(Reservoir_area_km2, na.rm = T),
            mean_reservoir_capacity = mean(Reservoir_capacity_million_m3, na.rm = T))

```


  How do these statistics differ by continent? Any thoughts on why they may differ?

**Looking at the averages I see that European dams typically have the greatest heights on average, with Oceania having the second greatest heights, and Africa, Americas, and Asia all having similar dam heights ranging between 32 and 34 meters. Looking at the mean reservoir areas I also see that Africa by far has the greatest average area at around 224 km^2, which is much greater than the continent containing the dams with the smallest area in Oceania at around 19.7 km^2. Some of these differences in reservoir area may be due to differences in the depth of the particular reservoir. For example, European dams obseerve a higher level of capacity than African dams despite having a lower reservoir area on average by around 130 km^2.  They are most likely able to achieve this due to their much greater depth based on the fact that Europe exhibits the highest dams of any continent attributing to them being more efficient at storing water than Africa. This more efficient storage of water due to increased depths allows for more water to be stored without flooding as much land.Looking at the averages of height, area, and storage I also noticed that continents with the greater reservoir areas and heights typically correlate with a greater level of storage on area. This increased capacity for water storage based on those two factors can be observed in Europe which has the highest average dam height by far, along with greater reservoir area than continents like Asia and Oceania at 91 km^2 on average. This contributes to Europe also achieving more effective storage of water than other continents at around 869.9 million m^3.Africa also achieves a high level of average storage as it has the greatest average reservoir areas by far contributing to it producing the second greatest average storage capacity of water. One continent that displays abnormally low average storage capacity is Asia, which likely observes lower levels of storage as has the second lowest mean dam height and the second lowest average reservoir area allocating to lower overall levels of mean storage.**  

```{r}
dams_data %>%
  ggplot(aes(x = Continent, y = Reservoir_capacity_million_m3)) +
  geom_boxplot() +
  
  scale_y_log10()
```

Once you've made your plot, take and look and note what you observe. Are distributions similar or different between continents?

**Looking at the model above I notice that the continents of Asia and the Americas contain several outlier that fall well below the magnitude of the majority of their dams.  This allows us to infer that their is a large quantity of low storage dams in these continents that may lead to a downward skew in storage results. Additionally, I noticed that Africa, the Americas, Asia, and Europe all contain outliers with a magnitude of storage much greater than the majority of their storage capacity values. I was particularly interested by how Africa and Asia have higher outlier magnitudes of storage with little to no outliers below the majority of their data. This elevated level of high storage capacity dams may lead to increased mean levels of storage capacity as well as overall higher levels of storage in these continents. This increased storage on average allows for more efficient water storage and a reduction in the amount of water loss through flooding/evaporation. Looking at the log based boxplot notice that overall distributions between continents are not similar over all, but some continents can be compared to one another on an individual basis.  For example, Africa and the Americas cover similar amounts of variance in storage data, but different values of storage data. I also recognize that Europe and Oceania achieve similar third quartile values in reference to their boxplots. One more feature that I notice is that is that Oceania and the Americas have similar median values to one another based on the log based scale.**

*Additional analysis*
```{r}
view(dams_data)
```

Changes in Dam storage capacity in the Americas over time after 1850.
```{r}
dams_data %>% 
  filter(Continent == "Americas", Year_completed >= 1850) %>% 
  ggplot(aes(x = Year_completed, y = Reservoir_capacity_million_m3)) + 
  geom_point(shape = 21, fill = "white") +
  scale_y_log10()
  
  

```
**This is a summary table displaying additional information about dams over time.**

What are possible reasons as to why there was a massive increase in the number of dams following the early 20th century?

**Over the course of the 20th century, globally we have seen a massive increase in our reliance of civil engineering to shape and enhance our societies.  As our population has grown and industrialization has taken place our need to control and have access to large supplies of water has increased. One particular area of development that has required access to large and ensured amounts of freshwater is our agriculutural systems. In order to avoid some of the struggles that result from drought we have discovered methods of building larger and more durable dams over time in order to prevent famine and starvation. One example of this process taking place is in the Western United States where many populations are reliant on the Colorado river. In order to divert water to such a large region dozens of dams have been built along the river altering its natural flow path. Another point I am interested in is the fact that dams are becoming less and less popular as many environmentalists, scientists, and engineers are realizing that we dams may lead to several potential hazards. These include risks such as flooding, high level of maitenance costs, and prevention of water from reaching its natural destination. In many scenarios these problems have been solved through tearing down old and inefficient dams over the last couple of decades. This movement away from dam usage has been beneificial in ensuring healthy water levels, restoring natural ecosystems reliant on a waterways water, and decreasing water diplomacy issues between states or countries.**




```{r}
select(dams_data, Dam_height_m, Reservoir_area_km2, Reservoir_capacity_million_m3, Continent, Country, Year_completed) %>% 
  group_by(Continent) %>% 
  summarize(mean_dam_height = mean(Dam_height_m, na.rm = T),
            max_dam_height = max(Dam_height_m, na.rm = T),
            min_dam_height = min(Dam_height_m, na.rm = T),
            mean_reservoir_area = mean(Reservoir_area_km2, na.rm = T),
            max_reservoir_area = max(Reservoir_area_km2, na.rm = T),
            min_reservoir_area = min(Reservoir_area_km2, na.rm = T),
            mean_reservoir_capacity = mean(Reservoir_capacity_million_m3, na.rm = T),
            max_reservoir_capacity = max(Reservoir_capacity_million_m3, na.rm = T),
            min_reservoir_capacity = min(Reservoir_capacity_million_m3, na.rm = T))
```

**This graph shows an increase in the total number of dams over time.**
```{r}
damsOvertime <- dams_data %>% 
select(Year_completed, Country, Continent) %>%
  drop_na(Year_completed)%>%
  count(Year_completed) %>% 
  filter(Year_completed > 1750) %>% 
  ggplot(aes(y = cumsum(n), x = Year_completed)) + 
  geom_line() +
  geom_point(shape = 21, fill = "white") + theme(panel.grid.major = element_line(colour = "ivory2"),
    panel.background = element_rect(fill = NA)) +labs(y = "Dams_Over_Time")
  
  damsOvertime
```
**The figure above depicts an increase in the total number of dams over time.**

Why do you think that the rate of dam completion decreases over time based on the information in the figure above?

**Regarding the total sum of worldwide dams over time I see the growth of dam use as direct cause of the development of agriculture and industrialization. The rate of dam completion has decreased over the past few decades as a large number of the waterways that are capable of being dammed, have already been dammed. Another factor to keep in mind is that scientists have began to realize that maybe the mass quantity of dams we have observed in the present may have serious economic and environmental risks. As a result of some of these negative implications we have begun to see a number of dams being torn down. I wonder if we created a model to predict the sum of dams in upcoming decades if we would see a gradual decrease in the global number of dams or even a flat curve. This would be an interesting topic to look into especially with the increase in the frequency of drought events and water shortage issues.**  



```{r}
# ggThemeAssistGadget(damsOvertime) + theme(panel.grid.major = element_line(colour = "ivory2"),
#    panel.background = element_rect(fill = NA)) +labs(y = "Dams_Over_Time")
```



```{r}
dam_table <- dams_data %>% 
  summarise(irrig = sum(Irrigation),
            w_supply = sum(Water_supply),
            hydelec = sum(Hydroelectricity),
            rec = sum(Recreation),
            pollution = sum(Pollution_control),
            nav = sum(Navigation),
            animals = sum(Livestock_rearing),
            flood = sum(Flood_control))
dam_table
```



```{r}
dam_chart <- dam_table %>% 
  pivot_longer(everything(),
               names_to = "dam_use")
dam_chart

```
**The figure below displays the distribution of water usage by different categories.**

**The summary table above displays a vairety of different categories where dams have been implemented.  Unsurprisingly irrigation is the dominant reason for dam building. As our global population has rapidly grown over the past century our reliance on agricultural innovation and development has become a necessity in continual raising of our global population's carrying capacity. In arid regions agriculture still is implemented as a vital role in societies and with the continual need for more food we must utilize our water resources to the best of our ability. Many have seen dams as a game changer allowing us to expand on the amount of area we can irrigate overall, while having a safety valve in the case of drought. In order to continue producing food at a high level in the future we must not solely rely on dams to control our water resources and implement more sustainable irrigation practices to ensure protection of the health of our natural ecosystems. We will be able to solve several food and water usage problems through using drip irrigation, soil moisture sensors, and even potentially monitoring head gates to decrease the level of water loss. Most of these practices revolve around decreasing the amount of water loss from ground infiltration or evaporation.** 
```{r}

dam_chart %>% 
  rename(water_usage = value) %>%  
ggplot(aes(x = dam_use , y = water_usage)) + 
  geom_col()
```
**The figure above gives us a visual reference on how different fields contribute to dam completion.**

```{r}
dam_table <- dam_table %>% 
  mutate(agriculture_usage = animals + irrig)

dam_table %>% 
  select(-irrig,-animals)
```
**The metric above was calculated in order to determine the number of dams built in response to agricultural needs.  I find it interesting that agriculture alone requires almost more dams than all of the other categories combined. It can also be argued that the flood category could somewhat be grouped into agricultural usage as it is an important process in providing sustenance to fields and preventing crop destruction.**
