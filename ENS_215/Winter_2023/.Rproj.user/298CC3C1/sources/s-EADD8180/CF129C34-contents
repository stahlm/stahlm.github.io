---
title: "Lab 2: Global Dams Data"
name: "Rachel Bryan"
data: "January 16, 2023"
output: html_document
---

# Introduction
This lab is based on data collected from dams in countries all over the world. The data includes, the exact location of each dam, the bodies of water they are part of, the years built, the dam height, area, and storage capacity of each reservoir, and the uses of each body of water. It was collected in order to address not only issues including the design, construction, and operation of dams, but the social, political and environmental factors which have sparked a major debate regarding the justification and benefits of dams. As I looked at the data, I focused most on how reservoir capacity varies across different regions of the world, and how it is influenced by not only the surface area of the reservoir, but by the height of each dam. 


```{r}
library(tidyverse)
```
```{r}
dams_data <- read_csv("https://stahlm.github.io/ENS_215/Data/Dams_FAO_SelectCols_LabData.csv")
```
```{r}
select(dams_data, Country, Dam_name, Dam_height_m, Year_completed)
```

## Reservoir Storage and Reservoir Area

```{r}

dams_data %>%
  ggplot(aes(x = Reservoir_capacity_million_m3, y = Reservoir_area_km2, color = Continent)) + geom_point() + 
  
  scale_x_log10() +
  scale_y_log10()

```

Observations: 

In general, we would typically expect for the reservoir capacity, which is how much water the reservoir can cold, correlates with the surface area of the reservoir, and this appears to be the case with the majority of the data. The larger the surface area of the reservoir, the more water it can hold. There are several outliers which are a result of varying reservoir depths. The data points with a high capacity and low surface area are probably from deeper reservoirs, while those with a large area and low capacity are shallower than the average. The majority of the data points are from Asia and the Americas, and this is likely because these are the continents with the largest surface areas, which is means they have more reservoirs total.


## Reservoir Storage and Dam Height

```{r}
dams_data %>%
  ggplot(aes(x = Dam_height_m, y = Reservoir_capacity_million_m3, color = Continent)) + geom_point() + 
  
  scale_x_log10() +
  scale_y_log10()
```

Observations:

Dam height tends to have an impact on reservoir capacity, where the taller the dam, the more water can be stored. The outliers in this graph could have been influenced by different sizes and surface areas for each reservoir. Reservoirs in Europe tend to have tall dams with reservoirs that hold a lot of water. The majority of the outliers with tall dams and low capacity are in Asia, while most of those with shorter dams and higher capacity are in the Americas. This suggests differences between dam building styles and geography in each of these parts of the world.


## Height, area and storage averages by continent

```{r}
dams_data %>%
  group_by(Continent) %>%
  summarize(mean_height = mean(Dam_height_m, na.rm = TRUE),
            mean_area = mean(Reservoir_area_km2, na.rm = T),
            mean_storage = mean(Reservoir_capacity_million_m3, na.rm = T)
            )

```

Observations:

Europe has the greatest average storage capacity because on average they have the tallest dams, and the second highest mean surface area. Asia has the lowest average storage capacity because it has by far the lowest surface area, and almost the lowest mean height. The data for Africa stood out to me, because while the mean dam height is similar to those in Asia and the Americas, the area is significantly greater than any other continent, yet the storage capacity is less than Europe and not much greater than the Americas. This leads me to believe that while the reservoirs cover a lot of ground, proportionally they do not hold as much water, which is a likely result of outside factors such as climate.

## Distribution of Reservoir Storage Capacities Between Continents

```{r}
dams_data %>%
  ggplot(aes(x = Continent, y = Reservoir_capacity_million_m3)) +
  geom_boxplot() +
  
  scale_y_log10()


```


Observations: 

On average, Europe has the highest mean capacity, while Africa has the lowest. Additionally, Europe has the highest minimum capacity, which is interesting because it is one of the smallest of the continents. I'd imagine this means that while there is a smaller surface area available, the reservoirs are deeper in comparison to those of other continents in order to support the large population. The reservoir capacity data for Asia appears to have many outliers, which may relate to the size of the continent. Since Asia is the largest, it makes sense that it would first of all have a large number of reservoirs, and many that exceed the min or max due to the diversity in the geography.  


# Additional Analysis: Distribution of Reservoir Storage Capacities in the Americas

## How does the reservoir storage differ between countries within the American continents?


```{r}
dams_data <- mutate(dams_data,
                 Continent = case_when(Continent == "Asia" ~ "Asia",
                                       Continent == "Oceania" ~ "Oceania",
                                       Continent == "Africa" ~ "Africa",
                                       Continent == "Europe" ~ "Europe",
                                       Continent == "Americas" & Country %in% c("Canada","Mexico","United States of America") ~ "North America",
                                       Continent == "Americas" & Country %in% c("Belize","Costa Rica","El Salvador","Guatemala","Honduras","Nicaragua","Panama") ~ "Central America",
                                       Continent == "Americas" & Country %in% c("Argentina","Brazil","Chile","Columbia","Ecuador","Guayana","Paraguay","Peru","Suriname","Uruguay","Bolivia (Plurinational State of)","Venezuela (Bolivarian Republic of)","French Guiana","Guyana") ~ "South America"))

dams_data %>%
  group_by(Continent) %>%
  summarize(mean_storage = mean(Reservoir_capacity_million_m3, na.rm = T)) 
```


After comparing the average reservoir capacities of each continent, I was curious about how this would vary within the Americas, which were combined into one. To do this I split the data into 3 new continents based on the country: North, South and Central America. When combined, the average storage was 636 million m3, which was the third greatest average, but when compared with each other, North America has the greatest average at 765 million m3, followed by Central America at 635 million m3, and finally South America, which has an average storage capacity of 585 million m3. 


### Distribution of Reservoir Storage Capacities between North, South and Central America


```{r}
dams_data %>%
  filter(Continent %in% c("North America","South America","Central America")) %>%
  ggplot(aes(x = Continent, y = Reservoir_capacity_million_m3)) +
  geom_boxplot() +  
  
  scale_y_log10()
```

The graph above shows the relationship in reservoir storage capacity between North, Central and South America. To reiterate the information from the table, North America has the greatest mean storage, while South America has the lowest. The box plot also shows that the minimum storage capacity of North American Reservoirs is greater than the average of both Central and South America. While South America has the lowest average, some of the outliers are very similar in capacity to those in North America, meaning the range in storage capacity is much greater in South America. Because Central America is the smallest of these regions, there are likely fewer existing dams and therefore no outliers.


### Distribution of Reservoir Storage Capacities in North America

```{r}
dams_data %>%
  filter(Continent %in% c("North America")) %>%
  ggplot(aes(x = Country, y = Reservoir_capacity_million_m3)) +
  geom_boxplot() +
  
  scale_y_log10()
```

Based on the data out of the three North American countries, Canada appears to have the widest range in storage capacity sizes, as well as the largest reservoirs in the continent. This could likely be attributed to the large size of the country with lots of unpopulated regions, and cooler weather in comparison with the rest of the American countries which minimized evaporation. The United States has the lowest average capacity, which was slightly surprising to me given the fact that it is larger than Mexico, and has a higher population (which means a greater demand for water).


### Distribution of Reservoir Storage Capacities in South America


```{r}
dams_data %>%
  filter(Continent %in% c("South America")) %>%
  ggplot(aes(x = Country, y = Reservoir_capacity_million_m3)) +
  geom_boxplot() +
  
  scale_y_log10()
```


In South America, based on the given data, most of the countries appear to have similar averages. The countries that have the widest ranges of storage capacity are Argentina and Brazil, the two largest countries (meaning they have some of the most variation in geography). Smaller countries have much less variation in data. For example, French Guiana and Suriname, which are both very small, only display an average on the graph. These are also notably much higher than those of other South American countries, which could mean that there are fewer reservoirs and therfore need to be larger, or that since the countries are smaller, data was only taken from the most significant reservoirs.


### Distribution of Reservoir Storage Capacities in Central America


```{r}
dams_data %>%
  filter(Continent %in% c("Central America")) %>%
  ggplot(aes(x = Country, y = Reservoir_capacity_million_m3)) +
  geom_boxplot() +
  
  scale_y_log10()
```


Finally, the countries in Central America with the widest range in data are Nicaragua and Honduras, which are some of the largest countries. Guatemala, which is also relatively large does not follow this pattern pattern however, and has the lowest average storage capacity (although the range is much wider when the outliers are considered).

# Conclusion

Based on the data analyzed in this lab, it can be concluded that reservoir storage capacity directly correlates with both reservoir surface area and dam height. Average storage capacities vary between different regions of the world, which likely is a result of factors including geography (such as size of country, existing bodies of water, or climate) as well as social influences like the population size (which influences the demand for water and for residential spaces) or the economic ability of each country to build dams and manipulate reservoirs.