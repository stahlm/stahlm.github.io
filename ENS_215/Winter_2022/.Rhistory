ylim(0,14)
fig_2 <- table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_a), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_a) +
xlim(0,1) +
ylim(0,14)
grid.arrange(fig_1, fig_2, ncol = 2)
library(tidyverse)
library(leaflet)
library(dataRetrieval)
sites_schdy_flow <- whatNWISsites(countyCd = "36093", parameterCd = c("00060","00010"))
sites_NY_flow <- whatNWISsites(stateCd = "NY", parameterCd = c("00060","00010"))
View(sites_schdy_flow)
sites_schdy_flow <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"),
site_tp_cd = "ST"
)
sites_schdy_flow <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"),
site_tp_cd = "ST"
)
flowAndTemp <- whatNWISdata(siteNumber = sites_NY_flow$site_no, service = "uv",
parameterCd = c("00060","00010"),
statCd = "00003")
sites_schdy_flow <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010")
)
View(sites_schdy_flow)
sites_schdy_flow <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"), site_tp_cd = "GW"
)
sites_schdy_flow <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010")
)
sites_schdy_flow <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"))
sites_schdy_flow
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"))
sites_schdy
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no, service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
View(flowAndTemp)
sites_schdy <- whatNWISsites(countyCd = "36001",
parameterCd = c("00060","00010"))
sites_schdy
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no, service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"))
sites_schdy
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no, service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"))
View(flowAndTemp)
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
stat_cd = "00030"
)
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
stat_cd = "00003"
)
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
View(sites_schdy)
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010")
statCd = "00003"
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"),
statCd = "00003"
)
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060"),
service = "dv"
)
sites_schdy
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00010"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
View(flowAndTemp)
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060"),
statCd = "00003")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00010"),
statCd = "00003",
service = "dv"
)
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00010"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00010"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00010"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
flowAndTemp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
View(flowAndTemp)
flow_temp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
flow_and_temp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
flow_and_temp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
flow_and_temp
sites_flow_and_temp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00010"),
statCd = "00003")
sites_flow_and_temp
df_flow_and_temp <- readNWISdv(siteNumbers = sites_flow_and_temp$site_no,
parameterCd = c("00060","00010"),
statCd = "00003")
View(df_flow_and_temp)
df_flow_and_temp <- df_flow_and_temp %>%
renameNWISColumns()
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Wtemp)) +
geom_line()
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line()
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Flow, color = site_no)) +
geom_line()
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Wtemp)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00095"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
sites_flow_and_temp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00095"),
statCd = "00003")
sites_flow_and_temp
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00065"),
service = "dv"
)
sites_schdy
sites_flow_and_temp <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00065"),
statCd = "00003")
sites_flow_and_temp
df_flow_and_temp <- readNWISdv(siteNumbers = sites_flow_and_temp$site_no,
parameterCd = c("00060","00065"),
statCd = "00003")
df_flow_and_temp <- df_flow_and_temp %>%
renameNWISColumns()
df_flow_and_temp %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_flow_and_temp %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_flow_and_temp %>%
ggplot(aes(x =GH, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_flow_and_temp %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data <- readNWISdv(siteNumbers = sites_what_data$site_no,
parameterCd = c("00060","00065"),
statCd = "00003")
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00065"),
service = "dv"
)
sites_schdy
sites_schdy <- sites_schdy %>%
filter(site_tp_cd == "ST")
sites_what_data <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00065"),
statCd = "00003")
sites_what_data
df_stream_data <- readNWISdv(siteNumbers = sites_what_data$site_no,
parameterCd = c("00060","00065"),
statCd = "00003")
df_stream_data <- df_stream_data %>%
renameNWISColumns()
df_stream_data %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(Flow)) %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(Flow)) %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
comment(siteINFO)
comment(sites_what_data$site_no)
siteINFO <- readNWISsite(sites_what_data$site_no)
View(siteINFO)
comment(sites_what_data$site_no)
comment(siteINFO)
sites_what_data %>%
leaflet() %>%
addProviderTiles(providers$OpenStreetMap) %>%
addMarkers(~ dec_long_va, ~ dec_lat_va, popup = ~ station_nm)
fig_map <- sites_what_data %>%
leaflet() %>%
addProviderTiles(providers$OpenStreetMap) %>%
addMarkers(~ dec_long_va, ~ dec_lat_va, popup = ~ station_nm)
fig_map
pCode <- c("00665")
phWI <- whatNWISdata(stateCd="WI",
parameterCd=pCode)
library(dplyr)
phWI.1 <- phWI %>%
filter(count_nu > 300) %>%
mutate(period = as.Date(end_date) - as.Date(begin_date)) %>%
filter(period > 15*365)
View(phWI.1)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode) %>%
filter(site_tp_cd == "GW")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
endDt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
end_dt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
end_date > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
endDt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
startDt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode
) %>%
filter(site_tp_cd == "GW")
View(NY_NO3)
library(lubridate)
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
View(NY_NO3_recent)
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3_recent$site_no, startDate = "2020-01-01", parameterCd = pCode)
View(NY_NO3_recent_data)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T))
View(NY_NO3_recent_data_summary)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
leaflet() %>%
addProviderTiles(providers$OpenStreetMap) %>%
addCircleMarkers(~ dec_long_va, ~ dec_lat_va, popup = ~ station_nm, color = ~ NO3_max)
fig_map_NO3
library(leaflet)
library(sf)
library(tmap)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_markers(col = "NO3_max")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_bubbles(col = "NO3_max")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 2)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.5)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.25)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "-RdBu")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
pCode <- c("00915")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode
) %>%
filter(site_tp_cd == "GW")
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3_recent$site_no,
startDate = "2020-01-01",
parameterCd = pCode)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
View(NY_NO3_recent_data)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va))
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va)) %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, endDate > "2020-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, endDate = "2020-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, startDate = "2020-01-01"
) %>%
filter(site_tp_cd == "GW")
View(NY_NO3)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, startDate = "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2025-01-01",
parameterCd = pCode)
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2015-01-01",
parameterCd = pCode)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va)) %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
