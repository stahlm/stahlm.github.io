df_stream_data <- readNWISdv(siteNumbers = sites_what_data$site_no,
parameterCd = c("00060","00065"),
statCd = "00003")
df_stream_data <- df_stream_data %>%
renameNWISColumns()
df_stream_data %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(GH)) %>%
ggplot(aes(x =Date, y = GH)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(Flow)) %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(Flow)) %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
comment(siteINFO)
comment(sites_what_data$site_no)
siteINFO <- readNWISsite(sites_what_data$site_no)
View(siteINFO)
comment(sites_what_data$site_no)
comment(siteINFO)
sites_what_data %>%
leaflet() %>%
addProviderTiles(providers$OpenStreetMap) %>%
addMarkers(~ dec_long_va, ~ dec_lat_va, popup = ~ station_nm)
fig_map <- sites_what_data %>%
leaflet() %>%
addProviderTiles(providers$OpenStreetMap) %>%
addMarkers(~ dec_long_va, ~ dec_lat_va, popup = ~ station_nm)
fig_map
pCode <- c("00665")
phWI <- whatNWISdata(stateCd="WI",
parameterCd=pCode)
library(dplyr)
phWI.1 <- phWI %>%
filter(count_nu > 300) %>%
mutate(period = as.Date(end_date) - as.Date(begin_date)) %>%
filter(period > 15*365)
View(phWI.1)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode) %>%
filter(site_tp_cd == "GW")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
endDt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
end_dt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
end_date > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
endDt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
startDt > "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode
) %>%
filter(site_tp_cd == "GW")
View(NY_NO3)
library(lubridate)
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
View(NY_NO3_recent)
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3_recent$site_no, startDate = "2020-01-01", parameterCd = pCode)
View(NY_NO3_recent_data)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T))
View(NY_NO3_recent_data_summary)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
leaflet() %>%
addProviderTiles(providers$OpenStreetMap) %>%
addCircleMarkers(~ dec_long_va, ~ dec_lat_va, popup = ~ station_nm, color = ~ NO3_max)
fig_map_NO3
library(leaflet)
library(sf)
library(tmap)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_markers(col = "NO3_max")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_bubbles(col = "NO3_max")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 2)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.5)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.25)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2)
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "-RdBu")
fig_map_NO3
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
pCode <- c("00915")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode
) %>%
filter(site_tp_cd == "GW")
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3_recent$site_no,
startDate = "2020-01-01",
parameterCd = pCode)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
View(NY_NO3_recent_data)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va))
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va)) %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, endDate > "2020-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, endDate = "2020-01-01"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, startDate = "2020-01-01"
) %>%
filter(site_tp_cd == "GW")
View(NY_NO3)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, startDate = "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2025-01-01",
parameterCd = pCode)
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2015-01-01",
parameterCd = pCode)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va)) %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
raster::plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
raster::plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
raster::plot(code_qr)
code_qr <- qrcode::qr_code("https://stahlm.github.io/ENS_215/Winter_2022/Lectures/2022_02_16.html")
raster::plot(code_qr)
library(stationaRy)
station_df <- get_station_metadata()
View(station_df)
station_met_data <- get_met_data(station_id = "725180-14735", years = 2020)
View(station_met_data)
station_met_data <- get_met_data(station_id = "725180-14735", years = 2021)
station_met_data <- get_met_data(station_id = "725180-14735", years = 2020)
library(rnoaa)
a <- isd(usaf = "725180", wban = "14735", year = 2021)
View(a)
library(GSODR)
isd_history <- load(system.file("extdata", "isd_history.rda", package = "GSODR"))
isd_history <- load(system.file("extdata", "isd_history.rda", package = "GSODR"))
library(GSODR)
isd_history <- load(system.file("extdata", "isd_history.rda", package = "GSODR"))
library(tidyverse)
library(lubridate)
library(leaflet)
library(sf)
library(tmap)
library(GSODR)
isd_history <- load(system.file("extdata", "isd_history.rda", package = "GSODR"))
isd_history
load(system.file("extdata", "isd_history.rda", package = "GSODR"))
isd_history <- load(system.file("extdata", "isd_history.rda", package = "GSODR"))
isd_history1 <- load(system.file("extdata", "isd_history.rda", package = "GSODR"))
load(system.file("extdata", "isd_history.rda", package = "GSODR"))
View(isd_history)
update_station_list()
load(system.file("extdata", "isd_history.rda", package = "GSODR"))
met_df <- get_GSOD(years = 2021:2022, station = "681100-99999")
View(met_df)
met_df %>%
ggplot() +
geom_line(aes(x = YEARMODA, y = MIN), color = "blue") +
geom_line(aes(x = YEARMODA, y = MAX), color = "red") +
labs(title = met_df$NAME[1],
x = "Date",
y = "Temperature (C)",
caption = paste("Data source GSOD station", met_df$STNID[1])
) +
theme_classic()
update_station_list()
load(system.file("extdata", "isd_history.rda", package = "GSODR"))
View(isd_history)
library(stationaRy)
station_df <- get_station_metadata()
station_met_data <- get_met_data(station_id = "725180-14735", years = 2021)
View(station_met_data)
station_met_data <- get_met_data(station_id = "725180-14735", years = 2020)
install.packages("worldmet")
library(worldmet)
worldmet::importNOAA(code = "725180-14735", year = 2021, hourly = T)
worldmet_data <- worldmet::importNOAA(code = "725180-14735", year = 2021, hourly = T)
View(worldmet_data)
View(station_met_data)
View(worldmet_data)
library(tidyverse)
library(lubridate)
library(moderndive)
precip_data <- read_csv("https://stahlm.github.io/ENS_215/Data/NOAA_State_Precip_LabData.csv")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
mutate(date = ymd(paste(Year,Month,15)) ) %>%
ggplot(aes(x = date, y = Precip_inches)) +
geom_line() +
geom_point() +
theme_classic() +
labs(x = "Year",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
ggplot(aes(x = Year, y = Precip_inches)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)",
title = "California Monthly Precipitation",
subtitle = "1980-2017",
caption = "Data source: NOAA")
flow <- read_csv("https://stahlm.github.io/ENS_215/Data/USGS_flow_01351500.csv") %>%
drop_na() %>%
filter(Year >= 1940 & Year <= 2016) %>%  # select years 1940 through 2016
mutate(date = make_date(Year, Month, Day)) # create a Date column that has the dates as an R date object
flow %>%
filter(Year >= 1980) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Flow (cfs)")
library(worldmet)
worldmet_data <- worldmet::importNOAA(code = "725180-14735",
year = 2021,
hourly = T)
worldmet_site_df <- getMeta()
worldmet_site_df <- getMeta(plot = F)
View(worldmet_site_df)
weatherCodes
View(worldmet_data)
View(worldmet_data)
library(tidyverse)
library(lubridate)
library(leaflet)
library(sf)
library(tmap)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, startDate = "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
library(dataRetrieval)
365*24
365*24
library(dataRetrieval)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode, startDate = "2015-01-01"
) %>%
filter(site_tp_cd == "GW")
View(NY_NO3)
dataRetrieval::parameterCdFile
dataRetrieval::parameterCdFile %>% filter(parameter_cd == pCode)
NY_NO3_recent <- NY_NO3 %>%
filter(end_date > make_date(2020,01,01))
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2015-01-01",
parameterCd = pCode)
NY_NO3_recent_data_summary <- NY_NO3_recent_data %>%
group_by(site_no) %>%
summarize(NO3_max = max(result_va, na.rm = T)) %>%
left_join(NY_NO3_recent)
tmap_mode("view")
fig_map_NO3 <- NY_NO3_recent_data_summary %>%
filter(!is.na(dec_lat_va), !is.na(dec_long_va)) %>%
st_as_sf(coords = c("dec_long_va", "dec_lat_va")) %>%
tm_shape() +
tm_dots(col = "NO3_max", style = "quantile", size = 0.2, palette = "viridis")
fig_map_NO3
getMeta()
getMeta(plot = T)
getMeta(plot = T)
a <-getMeta(plot = T)
getMeta(returnMap = T)
library(worldmet)
worldmet_data <- importNOAA(code = "725180-14735",
year = 2021:2022)
View(worldmet_data)
View(worldmet_data)
attr(worldmet_site_df)
attr(worldmet_data$date)
attr(worldmet_data$date, "tzone")
attr(worldmet_data)
attr(worldmet_data,"names")
attr(worldmet_data,"class")
worldmet_data %>%
ggplot(aes(x = date, y = visibility)) +
geom_point()
worldmet_data %>%
ggplot(aes(x = date, y = ws) +
geom_point()
worldmet_data %>%
ggplot(aes(x = date, y = ws)) +
geom_point()
worldmet_data %>%
ggplot(aes(x = date, y = RH)) +
geom_point()
worldmet_data %>%
ggplot(aes(x = date, y = RH)) +
geom_line()
worldmet_data %>%
ggplot(aes(x = date, y = RH)) +
geom_line() +
geom_smooth()
worldmet_data %>%
ggplot(aes(x = date, y = air_temp)) +
geom_line() +
geom_smooth()
worldmet_data %>%
ggplot(aes(x = date, y = air_temp)) +
geom_line() +
theme_bw()
worldmet_data %>%
ggplot(aes(x = date, y = RH)) +
geom_line() +
theme_bw()
parameterCdFile
usgs_parm_cd_df <- parameterCdFile
View(usgs_parm_cd_df)
unique(parameterCdFile$parameter_group_nm)
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
startDate = "2015-01-01", siteTpCd = "GW"
) %>%
filter(site_tp_cd == "GW")
pCode <- c("00618")
NY_NO3 <- whatNWISdata(stateCd="NY",
parameterCd=pCode,
startDate = "2015-01-01", site_tp_cd = "GW"
) %>%
filter(site_tp_cd == "GW")
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2015-01-01",
parameterCd = pCode)
View(NY_NO3_recent_data)
NY_NO3_recent_data <- readNWISqw(siteNumbers = NY_NO3$site_no,
startDate = "2015-01-01",
parameterCd = pCode) %>% renameNWISColumns()
View(NY_NO3_recent_data)
View(NY_NO3)
library(tidyverse)
library(lubridate)
library(leaflet)
