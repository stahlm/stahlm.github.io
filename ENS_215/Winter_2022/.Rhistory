precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p))
p
p <- c(0.01,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,0.99) # f-values to use in our quantile calculations
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p))
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p)) %>%
pivot_wider(names_from = state_cd,
values_from = q)
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p))
a <- precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p))
View(a)
a <- precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p)) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
a <- precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
fval = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
View(a)
a <- precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
#geom_density(alpha = 0.4) +
geom_density_ridges(aes(fill = state_cd)) +
theme_classic()
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
#geom_density(alpha = 0.4) +
geom_density_ridges(aes(y = state_cd)) +
theme_classic()
precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
geom_density(alpha = 0.4) +
theme_classic()
table_q_precip <- precip_data %>%
filter(state_cd %in% c("NY", "CT") ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
table_q_precip %>%
ggplot() +
geom_point(aes(x = CT, y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
state_a <- "NY"
state_b <- "CT"
table_q_precip <- precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
table_q_precip %>%
ggplot() +
geom_point(aes(x = state_a, y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes(x = state_a[1], y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes(x = CT, y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes(x = quote(state_a), y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
quote(state_a)
table_q_precip %>%
ggplot() +
geom_point(aes(x = quote(state_b), y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes(x = as.name(state_b), y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
state_a <- "NY"
state_b <- "CT"
table_q_precip <- precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
table_q_precip %>%
ggplot() +
geom_point(aes(x = as.name(state_b), y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= NY)) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
state_a <- "NY"
state_b <- "CT"
precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
geom_density(alpha = 0.4) +
theme_classic()
state_a <- "NY"
state_b <- "GA"
precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
geom_density(alpha = 0.4) +
theme_classic()
table_q_precip <- precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = "NY and CT",
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = paste(state_a, "and", state_b),
x = "CT Precipitation (inches)",
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = paste(state_a, "and", state_b),
x = paste(state_b, "Precipitation (inches)"),
y = "NY Precipitation (inches)")
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = paste(state_a, "and", state_b),
x = paste(state_b, "Precipitation (inches)"),
y = paste(state_a, "Precipitation (inches)"))
state_a <- "NY"
state_b <- "MA"
precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
geom_density(alpha = 0.4) +
theme_classic()
table_q_precip <- precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = paste(state_a, "and", state_b),
x = paste(state_b, "Precipitation (inches)"),
y = paste(state_a, "Precipitation (inches)"))
state_a <- "NY"
state_b <- "FL"
precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
geom_density(alpha = 0.4) +
theme_classic()
table_q_precip <- precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y= as.name(state_a))) +
geom_abline(slope = 1, intercept = 0) +
theme_classic() +
xlim(0, 16) +
ylim(0,16) +
coord_equal() +
labs(title = "Precipitation Q-Q plot",
subtitle = paste(state_a, "and", state_b),
x = paste(state_b, "Precipitation (inches)"),
y = paste(state_a, "Precipitation (inches)"))
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y = f_value))
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y = "f_value"))
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y = as.name("f_value")))
table_q_precip %>%
ggplot() +
geom_point(aes_(x = as.name(state_b), y = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = "Quantile plot: Batch A") +
xlim(0,1) +
ylim(4,16)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = "Quantile plot: Batch A") +
xlim(0,1) +
ylim(4,16)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = "Quantile plot: Batch A") +
xlim(0,1) +
ylim(0,16)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_b) +
xlim(0,1) +
ylim(0,16)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_a), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_a) +
xlim(0,1) +
ylim(0,16)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_b) +
xlim(0,1) +
ylim(0,14)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_a), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_a) +
xlim(0,1) +
ylim(0,14)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_b) +
xlim(0,1) +
ylim(0,14)
table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_a), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_a) +
xlim(0,1) +
ylim(0,14)
grid.arrange(fig_A, fig_B, ncol = 2)
fig_1 <- table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_b) +
xlim(0,1) +
ylim(0,14)
fig_2 <- table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_a), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_a) +
xlim(0,1) +
ylim(0,14)
grid.arrange(fig_1, fig_2, ncol = 2)
library(tidyverse)
library(stats)
precip_data <- read_csv("https://stahlm.github.io/ENS_215/Data/NOAA_State_Precip_LabData.csv")
p <- c(0.01,0.1,0.2,0.3,0.4,0.5,0.6,0.7,0.8,0.9,0.99) # f-values to use in our quantile calculations
state_a <- "NY"
state_b <- "FL"
precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
ggplot(aes(x = Precip_inches, fill = state_cd)) +
geom_density(alpha = 0.4) +
theme_classic()
table_q_precip <- precip_data %>%
filter(state_cd %in% c(state_a, state_b) ) %>%
group_by(state_cd) %>%
summarize(q = quantile(Precip_inches, probs = p),
f_value = p
) %>%
ungroup() %>%
pivot_wider(names_from = state_cd,
values_from = q)
table_q_precip
fig_1 <- table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_b), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_b) +
xlim(0,1) +
ylim(0,14)
fig_2 <- table_q_precip %>%
ggplot() +
geom_point(aes_(y = as.name(state_a), x = as.name("f_value"))) +
theme_classic() +
labs(x = "f-value",
y = "Observed value",
title = state_a) +
xlim(0,1) +
ylim(0,14)
grid.arrange(fig_1, fig_2, ncol = 2)
