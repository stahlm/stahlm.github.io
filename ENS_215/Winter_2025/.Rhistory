filter(flow_cfs >= 0,
lubridate::year(dateTime) >= 1950) %>%
mutate(Month = lubridate::month(dateTime),
Year = lubridate::year(dateTime)) %>%
select(dateTime, Year, Month, site_no, flow_cfs)
streamflows %>%
filter(site_no == "01357500") %>%
group_by(Year, Month) %>%
summarize(flow_stat = mean(flow_cfs, na.rm = T)) %>%
ungroup() %>%
mutate(Year = 1 + Year - min(Year)) %>%
ggplot(aes(x = Year, y = flow_stat)) +
geom_point() +
geom_smooth(method = "lm") +
theme_bw() +
facet_wrap(~ Month, scales = "free_y")
library(tidyverse)
library(gapminder)
precip_untidy_MA <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_untidy_MA.csv")
View(precip_untidy_MA)
precip_tidy_MA <- precip_untidy_MA %>%
pivot_longer(cols = month.abb, names_to = "Month",
values_to = "Precip_inches")
precip_tidy_MA <- precip_untidy_MA %>%
pivot_longer(cols = all_of(month.abb), names_to = "Month",
values_to = "Precip_inches")
View(precip_tidy_MA)
precip_untidy_MA <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_untidy_MA.csv")
precip_tidy_MA <- precip_untidy_MA %>%
pivot_longer(cols = all_of(month.abb), names_to = "Month",
values_to = "Precip_inches")
precip_temp_untidy_CA <- read_csv("https://stahlm.github.io/ENS_215/Data/CA_temp_precip_untidy.csv")
View(precip_temp_untidy_CA)
precip_temp_untidy_CA %>%
pivot_wider(names_from = measurement_type, values_from = measurement)
my_gap <- gapminder
my_gap <- gapminder
fig_ex1 <- my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x =reorder(country, pop), y = pop/10^6)) +
geom_point(size = 3) +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(x = "",
y = "Population (millions)",
title = "Population of European Countries",
subtitle = "Year 2007",
caption = "Data source: gapminder"
)
fig_ex1
gdp_change_table <- my_gap %>%
filter(year %in% c(1952, 2007)) %>%
group_by(country) %>%
arrange(country, year) %>%
summarize(continent = first(continent), gdp_1952 = first(gdpPercap), gdp_2007 = last(gdpPercap))
gdp_change_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007, color = continent)) +
geom_point() +
geom_abline(slope = 1, intercept = 0, color = "red") +
theme_bw() +
scale_x_log10(labels = trans_format('log10', math_format(10^.x)) ) +
scale_y_log10(labels = trans_format('log10', math_format(10^.x)), breaks = c(10^3, 10^4, 10^5) ) +
coord_equal(ratio = 1) +
facet_wrap(~continent) +
labs(x = "GDP per capita 1952 ($)",
y = "GDP per capita 2007 ($)",
title = "Per capita GDP over time",
subtitle = "Change between 1952 and 2007",
caption = "Data source: gapminder"
) +
theme(legend.position = "none")
library(tidyverse)
library(gapminder)
library(scales)
gdp_change_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007, color = continent)) +
geom_point() +
geom_abline(slope = 1, intercept = 0, color = "red") +
theme_bw() +
scale_x_log10(labels = trans_format('log10', math_format(10^.x)) ) +
scale_y_log10(labels = trans_format('log10', math_format(10^.x)), breaks = c(10^3, 10^4, 10^5) ) +
coord_equal(ratio = 1) +
facet_wrap(~continent) +
labs(x = "GDP per capita 1952 ($)",
y = "GDP per capita 2007 ($)",
title = "Per capita GDP over time",
subtitle = "Change between 1952 and 2007",
caption = "Data source: gapminder"
) +
theme(legend.position = "none")
library(tidyverse)
library(gapminder)
library(scales)
my_gap <- gapminder
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point()
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic()
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1))
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)")
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)",
x = ""
)
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)",
x = "",
title = "Population of European Countries (2007)"
)
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)",
x = "",
title = "Population of European Countries",
subtitle = "Year 2007"
)
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)",
x = "",
title = "Population of European Countries",
subtitle = "Year 2007",
caption = "Data source: Gapminder"
)
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)",
x = "",
title = "Population of European Countries",
subtitle = "Year 2007",
caption = "Data source: Gapminder",
color = "Population"
)
my_gap %>%
filter(continent == "Europe", year == 2007) %>%
ggplot(aes(x = reorder(country, pop), y = pop/10^6, color = pop/10^6)) +
geom_point() +
theme_classic() +
theme(axis.text.x = element_text(angle = 60, hjust = 1)) +
labs(y = "Population (millions)",
x = "",
title = "Population of European Countries",
subtitle = "Year 2007",
caption = "Data source: Gapminder",
color = "Population"
)
View(my_gap)
my_table <- my_gap %>%
filter(year %in% c(1952,2007))
View(my_gap)
View(my_table)
my_table <- my_gap %>%
filter(year %in% c(1952,2007)) %>%
group_by(country) %>%
arrange(country, year) %>%
summarize(continent = first(continent),
gdp_1952 = first(gdpPercap),
gdp_2007 = last(gdpPercap)
)
my_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007)) +
geom_point()
my_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007)) +
geom_point() +
geom_abline(slope = 1, intercept = 0, color = "red")
my_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007)) +
geom_point() +
geom_abline(slope = 1, intercept = 0, color = "red") +
coord_equal(ratio = 1)
my_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007)) +
geom_point() +
geom_abline(slope = 1, intercept = 0, color = "red") +
coord_equal(ratio = 1) +
facet_wrap(~continent)
my_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007)) +
geom_point(alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, color = "red") +
coord_equal(ratio = 1) +
facet_wrap(~continent)
my_table %>%
ggplot(aes(x = gdp_1952, y = gdp_2007, color = continent)) +
geom_point() +
geom_abline(slope = 1, intercept = 0, color = "red") +
theme_bw() +
scale_x_log10(labels = trans_format('log10', math_format(10^.x)) ) +
scale_y_log10(labels = trans_format('log10', math_format(10^.x)), breaks = c(10^3, 10^4, 10^5) ) +
coord_equal(ratio = 1) +
facet_wrap(~continent) +
labs(x = "GDP per capita 1952 ($)",
y = "GDP per capita 2007 ($)",
title = "Per capita GDP over time",
subtitle = "Change between 1952 and 2007",
caption = "Data source: gapminder"
) +
theme(legend.position = "none")
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = LifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country
))
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country
))
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country
)) +
geom_point()
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country
)) +
geom_point(aes(color = year))
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country
)) +
geom_point(aes(color = year)) +
geom_line()
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country,
)) +
geom_point(aes(color = year)) +
geom_line()
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country,
)) +
geom_point(aes(color = year)) +
geom_line() +
scale_color_continuous(low = "darkgrey", high = "black")
my_gap %>%
filter(continent == "Asia", year %in% c(1952, 2007)) %>%
ggplot(aes(x = lifeExp,
y = reorder(country, lifeExp, FUN = max),
group = country,
)) +
geom_point(aes(color = year)) +
geom_line() +
scale_color_continuous(low = "darkgrey", high = "black") +
theme_classic() +
theme(legend.position = "none") +
labs(title = "Change in life expectancy in Asia ",
subtitle = "1952 to 2007",
x = "Life expectancy (yrs)",
y = "",
caption = "1952 data (grey) and 2007 data (black)")
library(tidyverse)
precip_untidy_MA <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_untidy_MA.csv")
View(precip_untidy_MA)
month.abb
precip_tidy_MA <- precip_untidy_MA %>%
pivot_longer(cols = month.abb,
names_to = "Month",
values_to = "Precip_inches"
)
precip_tidy_MA
library(tidyverse)
precip_MA <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_MA.csv")
precip_NY <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_NY.csv")
precip_combined <- bind_rows(precip_MA, precip_NY)
# Your code here
# Your code here
dates_EPA <- read_csv("https://stahlm.github.io/ENS_215/Data/Sampling_dates_EPA_fish_tissue.csv")
dates_USGS <- read_csv("https://stahlm.github.io/ENS_215/Data/Sampling_dates_USGS_water_quality.csv")
dates_common <- intersect(dates_EPA, dates_USGS)
dates_only_USGS <- setdiff(dates_USGS, dates_EPA)
# Your code here
dates_USGS_EPA <- union(dates_USGS, dates_EPA)
years_USGS <- select(dates_USGS, Year)
months_days_USGS <- select(dates_USGS, Month, Day)
bind_example <- bind_cols(years_USGS, months_days_USGS)
head(bind_example)
temperature_data <- read_csv("https://stahlm.github.io/ENS_215/Data/NOAA_State_Temp_Lab_Data.csv")
temperature_data <- filter(temperature_data, !(Year == 2016 & state_cd == "NY")) # remove data for NY in year 2016
library(kableExtra)
head(precip_combined) %>%
kable() %>%
kable_styling(bootstrap_options = "condensed", position = "center") %>%
column_spec(column = c(1,2,4), background = "yellow") %>%
column_spec(column = c(3), background = "lightgrey")
head(temperature_data) %>%
kable() %>%
kable_styling(bootstrap_options = "condensed", position = "center") %>%
column_spec(column = c(1,2,4), background = "yellow") %>%
column_spec(column = c(3), background = "lightgrey")
climate_data <- inner_join(precip_combined, temperature_data)
head(climate_data)  %>%
kable() %>%
kable_styling(bootstrap_options = "condensed", position = "center")
climate_data <- left_join(precip_combined, temperature_data)
regions_data <- read_csv("https://stahlm.github.io/ENS_215/Data/state_regions.csv")
regions_data <- mutate(regions_data, state_cd = State_abb)
a <- left_join(climate_data, regions_data)
# Your code here
# Your code here
library(tidyverse)
precip_MA <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_MA.csv")
precip_NY <- read_csv("https://stahlm.github.io/ENS_215/Data/precip_NY.csv")
precip_combined <- bind_rows(precip_MA, precip_NY)
precip_switched <- select(precip_MA, state_cd, everything())
a <- bind_rows(precip_switched, precip_NY)
precip_switched <- select(precip_MA, -state_cd)
bind_rows(precip_switched, precip_NY)
dates_EPA <- read_csv("https://stahlm.github.io/ENS_215/Data/Sampling_dates_EPA_fish_tissue.csv")
dates_USGS <- read_csv("https://stahlm.github.io/ENS_215/Data/Sampling_dates_USGS_water_quality.csv")
dates_common <- intersect(dates_EPA, dates_USGS)
View(dates_common)
dates_only_USGS <- setdiff(dates_USGS, dates_EPA)
dates_EPA_only <- setdiff(dates_EPA, dates_USGS)
dates_USGS_EPA <- union(dates_USGS, dates_EPA)
years_USGS <- select(dates_USGS, Year)
months_days_USGS <- select(dates_USGS, Month, Day)
bind_example <- bind_cols(years_USGS, months_days_USGS)
head(bind_example)
temperature_data <- read_csv("https://stahlm.github.io/ENS_215/Data/NOAA_State_Temp_Lab_Data.csv")
temperature_data <- filter(temperature_data, !(Year == 2016 & state_cd == "NY")) # remove data for NY in year 2016
head(precip_combined)
head(temperature_data)
library(kableExtra)
head(precip_combined) %>%
kable() %>%
kable_styling(bootstrap_options = "condensed", position = "center") %>%
column_spec(column = c(1,2,4), background = "yellow") %>%
column_spec(column = c(3), background = "lightgrey")
head(temperature_data) %>%
kable() %>%
kable_styling(bootstrap_options = "condensed", position = "center") %>%
column_spec(column = c(1,2,4), background = "yellow") %>%
column_spec(column = c(3), background = "lightgrey")
climate_data <- inner_join(precip_combined, temperature_data)
head(climate_data)  %>%
kable() %>%
kable_styling(bootstrap_options = "condensed", position = "center")
climate_data <- left_join(precip_combined, temperature_data)
regions_data <- read_csv("https://stahlm.github.io/ENS_215/Data/state_regions.csv")
View(regions_data)
regions_data <- mutate(regions_data, state_cd = State_abb)
a <- left_join(climate_data, regions_data)
right_join(precip_combined, temperature_data)
right_join(temperature_data, precip_combined)
full_join(precip_combined, temperature_data)
full_join(temperature_data, precip_combined)
library(gapminder)
my_gap <- gapminder
dams_data <- read_csv("https://stahlm.github.io/ENS_215/Data/Dams_FAO_SelectCols_LabData.csv")
dams_data <- rename(dams_data, country = Country)
my_gap <- filter(my_gap, year == 2007) %>%
select(-lifeExp, -continent, -year)
dams_enhanced <- left_join(dams_data, my_gap)
View(dams_enhanced)
library(tidyverse)
library(dataRetrieval)
CT_sites_gw <- readWQPsummary(
statecode = "CT",
siteType = "Stream"
)
View(CT_sites_gw)
CT_usgs_sites <- CT_sites_gw %>%
filter(Provider == "NWIS")
CT_usgs_sites <- CT_sites_gw %>%
filter(Provider == "NWIS", CharacteristicName == "Chloride")
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:10],
characteristicName = "Chloride",
service = "StationWQX3"
)
View(data_sites)
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:10],
characteristicName = "Chloride",
service = "ResultWQX3"
)
View(data_sites)
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:10],
characteristicName = "Chloride",
dataProfile = "narrow",
service = "ResultWQX3"
)
View(data_sites)
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:100],
characteristicName = "Chloride",
dataProfile = "narrow",
service = "ResultWQX3"
)
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:10],
characteristicName = "Chloride",
dataProfile = "narrow",
service = "ResultWQX3"
)
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:20],
characteristicName = "Chloride",
dataProfile = "narrow",
service = "ResultWQX3"
)
View(data_sites)
data_sites <- readWQPdata(siteid = CT_usgs_sites$MonitoringLocationIdentifier[1:40],
characteristicName = "Chloride",
dataProfile = "narrow",
service = "ResultWQX3"
)
View(data_sites)
sites_schdy <- whatNWISsites(countyCd = "36093",
parameterCd = c("00060","00065"),
service = "dv"
)
View(sites_schdy)
sites_what_data <- whatNWISdata(siteNumber = sites_schdy$site_no,
service = "dv",
parameterCd = c("00060","00065"),
statCd = "00003")
View(sites_what_data)
df_stream_data <- readNWISdv(siteNumbers = sites_what_data$site_no,
parameterCd = c("00060","00065"),
statCd = "00003")
View(df_stream_data)
df_stream_data <- df_stream_data %>%
renameNWISColumns()
df_stream_data %>%
filter(!is.na(Flow)) %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
df_stream_data %>%
filter(!is.na(Flow), year(Date) > 2020) %>%
ggplot(aes(x =Date, y = Flow)) +
geom_line() +
facet_wrap(~ site_no, scales = "free")
pCode <- c("00618")
NY_NO3_sites <- whatWQPdata(stateCd = "NY",
parameterCd = pCode,
startDate = "2015-01-01"
) %>%
pCode <- c("00618")
NY_NO3_sites <- whatWQPdata(stateCd = "NY",
parameterCd = pCode,
startDate = "2015-01-01"
) %>%
filter(ResolvedMonitoringLocationTypeName %in% c("Well", "Spring"))
View(NY_NO3_sites)
NY_NO3_recent_data <- readWQPqw(siteNumbers = NY_NO3_sites$MonitoringLocationIdentifier,
parameterCd = pCode,
startDate = "2015-01-01"
)
NY_NO3_recent_data <- readWQPqw(siteNumbers = NY_NO3_sites$MonitoringLocationIdentifier,
parameterCd = pCode,
startDate = "2015-01-01", legacy = F
)
NY_NO3_recent_data <- readWQPqw(siteNumbers = NY_NO3_sites$MonitoringLocationIdentifier,
parameterCd = pCode,
startDate = "2015-01-01", legacy = F
)
NY_NO3_recent_data <- readWQPqw(siteNumbers = NY_NO3_sites$MonitoringLocationIdentifier,
parameterCd = pCode,
startDate = "2015-01-01", legacy = T
)
View(NY_NO3_recent_data)
