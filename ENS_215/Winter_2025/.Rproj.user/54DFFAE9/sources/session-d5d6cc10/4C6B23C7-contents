---
title: "EPA Fuel Economy Lab"
author: "Rosalind Lampert"
output:
  html_document:
    df_print: paged
---

### Load in packages
```{r}
library(tidyverse)
```
### Load in our data
```{r}
fuel_data <- mpg
```

### Examine the data
```{r}
str(fuel_data)
```

```{r}
n_rows <- nrow(fuel_data)
n_cols <- ncol(fuel_data)
n_rows
n_cols
```

Let's go ahead and summarize the data
```{r}
summary(fuel_data)
```
The most fuel efficient vehicle gets 44 highway miles per gallon. 
The least fuel efficient vehicle gets 12 highway miles per gallon.
The average miles per gallon for city driving is 16.86 miles per gallon.

### Add a new column
first way
```{r}
fuel_data$hwy2cty <- fuel_data$hwy / fuel_data$cty
```

second way
```{r}
fuel_data <- mutate(fuel_data, hwy2cty = hwy/cty)
```

```{r}
min(fuel_data$hwy2cty)
```

There is not a vehicle that gets better gas mileage in the city as compared to the highway. 

```{r}
max(fuel_data$hwy2cty)
```
There is not a vehicle that gets twice as good gas mileage; no number at 2 or above.
The maximum ratio between highway and city gas mileage is 1.66 .

### Examine factors: Displacement

```{r}
ggplot(data = fuel_data) +
  geom_point(aes(x = displ, y = hwy))
```

```{r}
ggplot(data = fuel_data) + 
  geom_point(aes(x = displ, y = hwy, color = class))
```

```{r}
ggplot(data = fuel_data) + 
  geom_point(aes(x = displ, y = hwy, color = year))
```
```{r}
ggplot(data = fuel_data) +
  geom_point(aes(x = displ, y = hwy)) +
  facet_wrap(~class)
```

Let's add one more variable. 
```{r}
us_makes <- c("chevrolet", "dodge", "ford", "jeep",
              "lincoln", "mercury", "pontiac")
```

```{r}
fuel_data <- mutate(fuel_data, region = if_else(manufacturer %in% 
        us_makes, "US", "Foreign"))
```
### Examine the relationship between displacement and region of make
```{r}
ggplot(data = fuel_data) + 
  geom_point(aes(x = displ, y = hwy, color = manufacturer)) +
    facet_wrap(~region)
```
This graph shows that foreign vehicles are more efficient compared to US-made 
vehicles. However, this may be due to volkswagen forging miles per gallon data
and making those cars look very efficient when in reality, they are not. 
Overall though, US-made cars do not have any engines with displacement below two.
Comparatively, the foreign makes do have engines with displacements below two.

### Examine the relationship between type of drive train and displacement
```{r}
ggplot(data = fuel_data) + 
  geom_point(aes(x = drv, y = displ, color = year))
```

This graph shows that 4-wheel drive tends to have a more variable displacement, 
while front wheel drive has a smaller engine and rear wheel drive has a larger
engine. Based on this data and the prior data with mileage vs. displacement, 
front wheel drive vehicles my be more efficient than rear wheel drive and four-
wheel drive. 

```{r}
ggplot(data = fuel_data) +
  geom_boxplot(aes(x = region, y = hwy))
```

This graph depicts highway miles versus foreign and US-made cars. From this graph, it is evident that foreign-made cars have a better mileage than US-made cars, which may be attributed to other factors such as engine size among other factors. 
