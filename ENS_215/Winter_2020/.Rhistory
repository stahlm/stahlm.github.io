geom_line() +
facet_wrap(~ Site_ID)
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = mean_gw, group = Year, color = Year)) +
geom_point() +
geom_line() +
facet_wrap(~ Site_ID)
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = mean_gw, group = Year, color = Year)) +
geom_point() +
geom_line() +
facet_wrap(~ Site_ID, scales = "free_y")
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = mean_gw, group = Year, color = Year)) +
geom_point() +
geom_line() +
scale_color_gradient(low = "red", high = "blue") +
theme_bw() +
facet_wrap(~ Site_ID, scales = "free_y")
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = mean_gw, group = Year, color = Year)) +
geom_point() +
geom_line() +
scale_color_gradient(low = "red", high = "blue") +
theme_bw() +
theme(legend.position = "none") +
facet_wrap(~ Site_ID, scales = "free_y")
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = Site_ID)) +
geom_raster()
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = Site_ID)) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
ggplot(aes(x = Month, y = Site_ID, fill = mean_gw)) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
month_rank = percent_rank(mean_gw)
n = n()) %>%
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
month_rank = percent_rank(mean_gw),
n = n()) %>%
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
month_rank = percent_rank(mean_gw),
n = n())
View(a)
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
month_rank = percent_rank(mean_gw, na.rm = T),
n = n()) %>%
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
geom_raster()
View(a)
a %>% percent_rank(mean_gw)
a %>% group_by(Site_ID) %>% summarize(gw_rank = percent_rank(mean_gw))
a %>% group_by(Site_ID, Month) %>% summarize(gw_rank = percent_rank(mean_gw))
a %>% group_by(Site_ID) %>% summarize(gw_rank = percent_rank(mean_gw))
a %>%  summarize(gw_rank = percent_rank(mean_gw))
a %>%  mutate(gw_rank = percent_rank(mean_gw))
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw))
View(a)
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw))
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
geom_raster()
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
scale_fill_gradient(low = "red", high = "blue") +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw))
View(a)
1/12
1/11
library(ggridges)
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
filter(month_rank == 0) %>%
ggridges::geom_density_ridges2(aes(x = Month))
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
filter(month_rank == 0) %>%
ggplot() +
ggridges::geom_density_ridges2(aes(x = Month))
#ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
#scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
#geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
filter(month_rank == 0) %>%
ggplot() +
ggridges::geom_density_ridges2(aes(x = Month, y = Site_ID))
#ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
#scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
#geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
filter(month_rank == 0) %>%
ggplot() +
ggridges::geom_density_ridges2(aes(x = Month, y = Site_ID), stat = "binline")
#ggplot(aes(x = Month, y = Site_ID, fill = month_rank)) +
#scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
#geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw))
View(a)
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0))
View(a)
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
summarize(min_prop = min_count/n())
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
ungroup() %>%
group_by(Site_ID) %>%
summarize(min_prop = min_count/n())
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
summarize(min_prop = n())
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID, Month) %>%
summarize(min_prop = n())
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID, Month) %>%
summarize(min_prop = n(),
min_count = min_count)
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID)
mutate(min_prop = min_count/sum(min_count))
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
mutate(min_prop = min_count/sum(min_count))
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
mutate(min_prop = min_count/sum(min_count)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = min_prop)) +
scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
geom_raster()
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
mutate(min_prop = min_count/sum(min_count)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = min_prop)) +
scale_fill_gradient2(low = "red", mid = "green", high = "blue", midpoint = 0.5) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
mutate(min_prop = min_count/sum(min_count)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = min_prop)) +
scale_fill_gradient2(low = "blue", mid = "green", high = "red", midpoint = 0.5) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
mutate(min_prop = min_count/sum(min_count)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = min_prop)) +
scale_fill_gradient2(low = "blue", mid = "green", high = "red", midpoint = 0.25) +
geom_raster()
a
a <- gw_levels %>%
group_by(Site_ID, Year) %>%
filter(length(unique(Month)) > 11) %>%
group_by(Site_ID, Year, Month) %>%
summarize(mean_gw = mean(Water_level__ft),
min_gw = min(Water_level__ft),
max_gw = max(Water_level__ft),
n = n()) %>%
mutate(month_rank = percent_rank(mean_gw)) %>%
group_by(Site_ID, Month) %>%
summarise(min_count = sum(month_rank == 0)) %>%
group_by(Site_ID) %>%
mutate(min_prop = min_count/sum(min_count)) %>%
ggplot(aes(x = Month, y = Site_ID, fill = min_prop)) +
scale_fill_gradient() +
geom_raster()
a
sun
Deaths.Dat
library(forecast)
install.packages("forecast")
library(forecast)
gold
ldeaths
b<-ldeaths
flow <- read_csv("https://stahlm.github.io/ENS_215/Data/USGS_flow_01351500.csv") %>%
drop_na() %>%
filter(Year >= 1940 & Year <= 2016) %>%  # select years 1940 through 2016
mutate(Date = make_date(Year, Month, Day)) # create a Date column that has the dates as an R date object
flow_monthly <- flow %>%
group_by(Year, Month) %>%
summarize(flow_cfs = mean(flow_cfs))
924/12
unique(flow_monthly$Year)
2016-1940
ts(flow_monthly$flow_cfs, start = 1940, freq = 12)
flow_ts <- ts(flow_monthly$flow_cfs, start = 1940, freq = 12)
spectrum(flow_ts)
flow_ts <- ts(flow$flow_cfs, start = 1940, freq = 365)
spectrum(flow_ts)
flow_monthly <- flow %>%
group_by(Year, Month) %>%
summarize(flow_cfs = max(flow_cfs))
flow_ts <- ts(flow_monthly$flow_cfs, start = 1940, freq = 12)
spectrum(flow_ts)
