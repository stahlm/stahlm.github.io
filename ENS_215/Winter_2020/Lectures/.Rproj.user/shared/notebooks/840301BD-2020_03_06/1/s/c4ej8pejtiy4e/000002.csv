"0","state_climate_summary_map <- function(climate_data, state_abbrev){"
"0","  "
"0","  state_names_table <- tibble(state_name = tolower(state.name), state_abb = state.abb)"
"0","  state_names_table <- state_names_table %>% "
"0","    filter(state_abb == state_abbrev)"
"0","  "
"0","  state_name_current <- state_names_table$state_name"
"0","  "
"0","  table_months <- climate_data %>% "
"0","    filter(state_cd == state_abbrev) %>% "
"0","    group_by(Month) %>% "
"0","    summarise(month_mean = mean(Avg_Temp_F), month_max = max(Avg_Temp_F), month_min = min(Avg_Temp_F) )"
"0","  "
"0","  table_annual <- climate_data %>% "
"0","    filter(state_cd == state_abbrev) %>%"
"0","    group_by(Year) %>% "
"0","    summarise(annual_mean = mean(Avg_Temp_F)) "
"0","  "
"0","  "
"0","  fig_annual <- table_annual %>% "
"0","    ggplot(aes(x = Year, y = annual_mean)) +"
"0","    geom_line() +"
"0","    geom_point() +"
"0","    geom_smooth(method = ""lm"") +"
"0","    labs(title = paste(""Annual mean temperature:"",state_abbrev),"
"0","         x = """","
"0","         y = ""Annual Mean Temp (F)"","
"0","         caption = ""Data source: NOAA"") +"
"0","    theme_classic()"
"0","  "
"0","  fig_monthly <- climate_data %>% "
"0","    mutate(Month = as.factor(Month)) %>% "
"0","    ggplot(aes(x = Month, y = Avg_Temp_F)) +"
"0","    geom_boxplot() +"
"0","    labs(title = paste(""Monthly temperatures:"",state_abbrev),"
"0","         x = """","
"0","         y = ""Temp (F)"","
"0","         caption = ""Data source: NOAA"") +"
"0","    theme_classic()"
"0","  "
"0","  map_data_state <- map_data(""state"") %>% "
"0","    filter(region == state_name_current)"
"0","  "
"0","  fig_map <- map_data_state %>% "
"0","    ggplot() +"
"0","    geom_polygon(aes(long, lat, group = group), color = ""black"", fill = ""gray"") +"
"0","    coord_map(projection = ""bonne"", lat0 = 50) +"
"0","    theme_void()"
"0","  combined_fig <- fig_map / (fig_monthly / fig_annual)"
"0","  return(combined_fig)"
"0","  "
"0","  #list(table_months, table_annual, fig_annual)"
"0","  "
"0","}"
