ggplot(aes(x = Month, y = Precip_inches))
fig_precip
fig_precip <- precip_data %>%
filter(Year >= 2012,
state_cd == "NY") %>%
ggplot(aes(x = Month, y = Precip_inches)) +
geom_boxplot()
fig_precip
fig_precip <- precip_data %>%
filter(Year >= 2012,
state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot()
fig_precip
fig_precip <- precip_data %>%
filter(Year >= 2000,
state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot()
fig_precip
fig_precip <- precip_data %>%
filter(state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot()
fig_precip
fig_stream_1 + fig_precip / fig_stream_1
fig_stream_2 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = as.factor(Month), y = flow_cfs)) +
geom_boxplot(outlier.shape = NA) +
scale_y_log10()
fig_stream_2
fig_stream_1 + fig_precip / fig_stream_1
fig_stream_1 + fig_precip / fig_stream_2
fig_precip <- precip_data %>%
filter(state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot() +
labs(x = "Month",
y = "Precip (inches)")
fig_precip
fig_precip <- precip_data %>%
filter(state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot(outlier.shape = NA) +
labs(x = "Month",
y = "Precip (inches)") +
theme_classic()
fig_precip
fig_precip <- precip_data %>%
filter(state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot(outlier.shape = NA) +
labs(x = "Month",
y = "Precip (inches)") +
theme_bw()
fig_precip
fig_precip <- precip_data %>%
filter(state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot(outlier.shape = NA, fill = "lightgrey") +
labs(x = "Month",
y = "Precip (inches)") +
theme_bw()
fig_precip
fig_stream_2 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = as.factor(Month), y = flow_cfs)) +
geom_boxplot(outlier.shape = NA, fill = "lightgrey") +
scale_y_log10() +
theme_bw()
fig_stream_2
fig_stream_2 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = as.factor(Month), y = flow_cfs)) +
geom_boxplot(outlier.shape = NA, fill = "lightgrey") +
scale_y_log10() +
theme_bw() +
labs(x = "Month",
y = "Flow (cfs)")
fig_stream_2
fig_stream_1 + fig_precip / fig_stream_2
fig_stream_1 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = date, y = flow_cfs)) +
geom_line() +
theme_bw() +
labs(x = "",
y = "Flow (cfs)")
fig_stream_1
fig_stream_1 + fig_precip / fig_stream_2
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'The surprising story about mtcars')
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'Schoharie Creek Hydrology')
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'Schoharie Creek Hydrology',
tag_levels = 'I')
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'Schoharie Creek Hydrology',
tag_levels = 'A')
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'Schoharie Creek Hydrology',
tag_levels = 'A',
caption = "A: Daily streamflow at Schoharie Creek;
B: Distribution of monthly precipitation in New York (1896-2017);
C: Distribution of Schoharie Creek daily flows by month")
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'Schoharie Creek Hydrology',
tag_levels = 'A')
fig_stream_1 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = date, y = flow_cfs)) +
geom_line() +
theme_bw() +
labs(x = "",
y = "Flow (cfs)")
fig_stream_1
fig_stream_1 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = date, y = flow_cfs)) +
geom_line() +
theme_bw() +
labs(x = "",
y = "Flow (cfs)")
fig_stream_1
fig_stream_2 <- flow %>%
filter(Year >= 2012) %>%
ggplot(aes(x = as.factor(Month), y = flow_cfs)) +
geom_boxplot(outlier.shape = NA, fill = "lightgrey") +
scale_y_log10() +
theme_bw() +
labs(x = "Month",
y = "Flow (cfs)")
fig_stream_2
fig_precip <- precip_data %>%
filter(state_cd == "NY") %>%
ggplot(aes(x = as.factor(Month), y = Precip_inches)) +
geom_boxplot(outlier.shape = NA, fill = "lightgrey") +
labs(x = "Month",
y = "Precip (inches)") +
theme_bw()
fig_precip
fig_stream_1 + (fig_precip / fig_stream_2)
fig_stream_1 | (fig_precip / fig_stream_2)
( fig_stream_1 + (fig_precip / fig_stream_2) ) +
plot_annotation(title = 'Schoharie Creek Hydrology',
tag_levels = 'A')
View(flow)
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T))
View(flow_summary)
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
mutate(Year = 2020)
View(flow_summary)
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
mutate(date = ymd(2020, Month, Day))
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
mutate(date = ymd(paste(2020, Month, Day)))
calendarPlot(flow_summary, pollutant = "mean_flow_cfs", year = 2020,
cols = RColorBrewer::brewer.pal(n = 10, name = "RdBu") )
calendarPlot(flow_summary, pollutant = "mean_flow_cfs", year = 2020,
cols = RColorBrewer::brewer.pal(n = 8, name = "RdBu") )
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = max(flow_cfs, na.rm = T)) %>%
mutate(date = ymd(paste(2020, Month, Day)))
calendarPlot(flow_summary, pollutant = "mean_flow_cfs", year = 2020,
cols = RColorBrewer::brewer.pal(n = 10, name = "RdBu") )
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = median(flow_cfs, na.rm = T)) %>%
mutate(date = ymd(paste(2020, Month, Day)))
calendarPlot(flow_summary, pollutant = "mean_flow_cfs", year = 2020,
cols = RColorBrewer::brewer.pal(n = 10, name = "RdBu") )
flow_summary <- flow %>%
group_by(Month, Day) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
mutate(date = ymd(paste(2020, Month, Day)))
calendarPlot(flow_summary, pollutant = "mean_flow_cfs", year = 2020,
cols = RColorBrewer::brewer.pal(n = 10, name = "RdBu") )
mauna_loa %>%
ggplot(aes(x = Year, y = CO2_ppm)) +
facet_wrap(~ Month, ncol = 12)
mauna_loa %>%
ggplot(aes(x = Year, y = CO2_ppm)) +
geom_point() +
facet_wrap(~ Month, ncol = 12)
mauna_loa %>%
ggplot(aes(x = Year, y = CO2_ppm)) +
geom_point() +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
flow %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
flow %>%
filter(Year > 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
mauna_loa %>%
filter(Year >= 2000) %>%
ggplot(aes(x = Year, y = CO2_ppm)) +
geom_point() +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth() +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F) +
facet_wrap(~ Month, ncol = 12) +
theme(axis.text.x = element_blank())
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F) +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank())
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank())
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Flow (cfs)")
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Flow (cfs)")
flow %>%
filter(Year >= 2000) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Flow (cfs)")
precip_data %>%
filter(Year >= 2000,
state_cd == "NY") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1990,
state_cd == "NY") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1990,
state_cd == "CA") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1990,
state_cd == "CA") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1990,
state_cd == "FL") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1990,
state_cd == "MA") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "FL") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
group_by(Year, Month) %>%
summarize(mean_precip = mean(Precip_inches, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_precip)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
flow %>%
filter(Year >= 1980) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Flow (cfs)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
ggplot(aes(x = Year, y = Precip_inches)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
ggplot(aes(x = Year, y = Precip_inches)) +
geom_line() +
geom_point() +
theme_classic() +
labs(x = "Year",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
mutate(date = ymd(paste(Year,Month,15)) ) %>%
ggplot(aes(x = date, y = Precip_inches)) +
geom_line() +
geom_point() +
theme_classic() +
labs(x = "Year",
y = "Precip (inches)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
mutate(date = ymd(paste(Year,Month,15)) ) %>%
ggplot(aes(x = date, y = Precip_inches)) +
geom_line() +
geom_point() +
theme_classic() +
labs(x = "Year",
y = "Precip (inches)")
View(precip_data)
flow %>%
filter(Year >= 1980) %>%
group_by(Year, Month) %>%
summarize(mean_flow_cfs = mean(flow_cfs, na.rm = T)) %>%
ggplot(aes(x = Year, y = mean_flow_cfs)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Flow (cfs)")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
ggplot(aes(x = Year, y = Precip_inches)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)",
title = "California Monthly Precipitation",
subtitle = "1980-2017")
precip_data %>%
filter(Year >= 1980,
state_cd == "CA") %>%
ggplot(aes(x = Year, y = Precip_inches)) +
geom_point() +
geom_smooth(se = F, method = "lm") +
facet_wrap(~ Month, ncol = 12) +
theme_classic() +
theme(axis.text.x = element_blank()) +
labs(x = "",
y = "Precip (inches)",
title = "California Monthly Precipitation",
subtitle = "1980-2017",
caption = "Data source: NOAA")
