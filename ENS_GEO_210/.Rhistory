sr_bbox = 4326, sr_image = 4326)
elev_img <- raster::raster(elev_file)
raster::plot(elev_img)
raster::contour(elev_img, levels = seq(50,150, by = 5),
add = T)
# define bounding box with longitude/latitude coordinates (Schenectady)
bbox <- list(
p1 = list(long = -73.836209 + 0.11, lat = 42.787780 - 0.11/2), # bottom-left
p2 = list(long = -73.836209 - 0.11, lat = 42.787780 + 0.11/2)   # top-right
)
image_size <- define_image_size(bbox, major_dim = 600)
# download elevation data
elev_file <- file.path("../data", "lishakill-elevation.tif")
get_usgs_elevation_data(bbox, size = image_size$size, file = elev_file,
sr_bbox = 4326, sr_image = 4326)
elev_img <- raster::raster(elev_file)
# download elevation data
elev_file <- file.path("../data", "lishakill-elevation.tif")
get_usgs_elevation_data(bbox, size = image_size$size, file = elev_file,
sr_bbox = 4326, sr_image = 4326)
elev_img <- raster::raster(elev_file)
raster::plot(elev_img)
raster::contour(elev_img, levels = seq(50,150, by = 5),
add = T)
raster::plot(elev_img)
raster::contour(elev_img, levels = seq(50,150, by = 10),
add = T)
# define bounding box with longitude/latitude coordinates (Schenectady)
bbox <- list(
p1 = list(long = -73.836209 + 0.11, lat = 42.787780 - 0.11/1,5), # bottom-left
p2 = list(long = -73.836209 - 0.11, lat = 42.787780 + 0.11/2)   # top-right
)
# define bounding box with longitude/latitude coordinates (Schenectady)
bbox <- list(
p1 = list(long = -73.836209 + 0.11, lat = 42.787780 - 0.11/1.5), # bottom-left
p2 = list(long = -73.836209 - 0.11, lat = 42.787780 + 0.11/2)   # top-right
)
image_size <- define_image_size(bbox, major_dim = 600)
# download elevation data
elev_file <- file.path("../data", "lishakill-elevation.tif")
get_usgs_elevation_data(bbox, size = image_size$size, file = elev_file,
sr_bbox = 4326, sr_image = 4326)
elev_img <- raster::raster(elev_file)
elev_img <- raster::raster(elev_file)
# download elevation data
elev_file <- file.path("../data", "lishakill-elevation.tif")
get_usgs_elevation_data(bbox, size = image_size$size, file = elev_file,
sr_bbox = 4326, sr_image = 4326)
elev_img <- raster::raster(elev_file)
closeAllConnections()
# download elevation data
elev_file <- file.path("../data", "lishakill-elevation.tif")
get_usgs_elevation_data(bbox, size = image_size$size, file = elev_file,
sr_bbox = 4326, sr_image = 4326)
closeAllConnections()
elev_img <- raster::raster(elev_file)
raster::plot(elev_img)
raster::contour(elev_img, levels = seq(50,150, by = 10),
add = T)
raster::plot(elev_img)
raster::contour(elev_img, levels = seq(50,150, by = 10),
add = F)
shape_watershed <- st_read("../data/lisha_kill_watershed/area-of_interest.shp", stringsAsFactors = FALSE)
library(rayshader)
library(sf)
library(tmap)
shape_watershed <- st_read("../data/lisha_kill_watershed/area-of_interest.shp", stringsAsFactors = FALSE)
shape_watershed <- st_read("../data/lisha_kill_watershed/area-of-interest.shp", stringsAsFactors = FALSE)
tm_shape(elev_img) +
tm_raster()
tm_shape(elev_img) +
tm_raster() +
tm_shape(shape_watershed) +
tm_borders()
tm_shape(elev_img) +
tm_raster() +
tm_shape(shape_watershed) +
tm_borders(col = "black")
tm_shape(elev_img) +
tm_raster(style = "cont") +
tm_shape(shape_watershed) +
tm_borders(col = "black")
min(elev_img)
min(elev_img$lishakill.elevation)
raster::cellStats(elev_img)
raster::cellStats(elev_img, stat = "min")
raster::cellStats(elev_img, stat = "max")
raster_elev_LK <- raster::mask(elev_img,
shape_watershed)
raster::plot(raster_elev_LK)
raster_elev_LK <- raster::mask(raster_elev_LK,
shape_watershed)
raster::plot(raster_elev_LK)
raster_elev_LK <- raster::crop(raster_elev_LK,
shape_watershed)
raster::plot(raster_elev_LK)
elmat <- matrix(
raster::extract(raster_elev_LK, raster::extent(raster_elev_LK), buffer = 1000),
nrow = ncol(raster_elev_LK), ncol = nrow(raster_elev_LK)
)
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_contour_overlay(elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
#add_overlay(generate_contour_overlay(elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat <- matrix(
raster::extract(elev_img, raster::extent(elev_img), buffer = 1000),
nrow = ncol(elev_img), ncol = nrow(elev_img)
)
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
#add_overlay(generate_contour_overlay(elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed
)  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed)  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed))  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed), attr(elmat,"extent"))  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed, attr(elmat,"extent")))  %>%
plot_map()
elmat
elev_img %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed, attr(elev_img,"extent")))  %>%
plot_map()
raster::extent(elmat)
raster::extent(elev_img)
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(raster::extent(elev_img),"extent")))  %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed, extent = raster::extent(elev_img)))  %>%
plot_map()
a <- montereybay
elmat %>%
height_shade() %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
add_shadow(ray_shade(elmat,zscale=50),0.3) %>%
plot_map()
attr(elmat, "extent")
attr(montereybay,"extent")
elmat$Extent <- raster::extent(elev_img)
elmat = raster_to_matrix(elev_img)
elmat %>%
height_shade() %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
add_shadow(ray_shade(elmat,zscale=50),0.3) %>%
plot_map()
elmat <- matrix(
raster::extract(elev_img, raster::extent(elev_img), buffer = 1000),
nrow = ncol(elev_img), ncol = nrow(elev_img)
)
elev_img
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
#add_overlay(generate_line_overlay(shape_watershed, attr()))  %>%
plot_map()
elmat = raster_to_matrix(elev_img)
elmat <- matrix(
raster::extract(elev_img, raster::extent(elev_img), buffer = 1000),
nrow = ncol(elev_img), ncol = nrow(elev_img)
)
elmat <- raster::as.matrix(
raster::extract(elev_img, raster::extent(elev_img), buffer = 1000),
nrow = ncol(elev_img), ncol = nrow(elev_img)
)
elmat <- raster::as.matrix(
raster::extract(elev_img, raster::extent(elev_img), buffer = 1000),
nrow = ncol(elev_img), ncol = nrow(elev_img)
)
elmat <- raster::as.matrix(elev_img)
attr(a)
View(a)
bbox$p1
bbox$p1[[]]
bbox$p1[]
b <- bbox$p1
b
bottom_left = c(y=-122.366765, x=36.179392)
b <- bbox$p1[1]
b <- bbox$p1[[1]]
b <- bbox$p1[[]]
b <- bbox$p1[[1:2]]
b <- bbox$p1[[2]]
b <- bbox$p1[[1]]
bottom_left <- c(bbox$p1[[1]], bbox$p1[[2]])
bottom_left <- c(bbox$p1[[1]], bbox$p1[[2]])
top_rigth <- c(bbox$p2[[1]], bbox$p2[[2]])
bottom_left <- c(bbox$p1[[1]], bbox$p1[[2]])
top_right <- c(bbox$p2[[1]], bbox$p2[[2]])
top_right
elmat = raster_to_matrix(elev_img)
bottom_left <- c(bbox$p1[[1]], bbox$p1[[2]])
top_right <- c(bbox$p2[[1]], bbox$p2[[2]])
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = crs(elev_img)
crs(elmat) <- ""+proj=longlat +ellps=WGS84 +datum=WGS84""
crs(elmat) <- "+proj=longlat +ellps=WGS84 +datum=WGS84"
raster::crs(elmat) <- "+proj=longlat +ellps=WGS84 +datum=WGS84"
crs(elev_img)
raster::crs(elev_img)
raster::crs(elev_img) <- "+proj=longlat +ellps=WGS84 +datum=WGS84"
elmat = raster_to_matrix(elev_img)
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = crs(elev_img)
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "rayshader_data") = TRUE
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_contour_overlay(elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
bottom_left <- c(y = bbox$p1[[1]],x= bbox$p1[[2]])
top_right <- c(y = bbox$p2[[1]], x= bbox$p2[[2]])
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "rayshader_data") = TRUE
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat = raster_to_matrix(elev_img)
bottom_left <- c(y = bbox$p1[[1]],x= bbox$p1[[2]])
top_right <- c(y = bbox$p2[[1]], x= bbox$p2[[2]])
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
raster::crs(elev_img)
sf::st_crs(shape_watershed)
elev_img
raster::crs(elev_img) <- "+proj=longlat +ellps=WGS84 +datum=WGS84"
elev_img
elmat = raster_to_matrix(elev_img)
bottom_left <- c(y = bbox$p1[[1]],x= bbox$p1[[2]])
top_right <- c(y = bbox$p2[[1]], x= bbox$p2[[2]])
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "rayshader_data") = TRUE
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
shape_watershed = sf::st_crop(shape_watershed, attr(elmat,"extent"))
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
shape_watershed = sf::st_crop(shape_watershed, attr(elmat,"extent"))
shape_watershed = sf::st_crop(shape_watershed, attr(elev_img,"extent"))
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat = raster_to_matrix(elev_img)
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "rayshader_data") = TRUE
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=raster::crs("+proj=longlat +ellps=WGS84 +datum=WGS84"))
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "rayshader_data") = TRUE
shape_watershed = sf::st_crop(shape_watershed, attr(elev_img,"extent"))
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_line_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
raster::plot(raster_elev_LK)
elmat = raster_to_matrix(elev_img)
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_contour_overlay(elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat = raster_to_matrix(raster_elev_LK)
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
#add_overlay(generate_contour_overlay(elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
raster::crs(elev_img) <- "+proj=longlat +ellps=WGS84 +datum=WGS84"
elmat = raster_to_matrix(elev_img)
bottom_left <- c(y = bbox$p1[[1]],x= bbox$p1[[2]])
top_right <- c(y = bbox$p2[[1]], x= bbox$p2[[2]])
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=raster::crs("+proj=longlat +ellps=WGS84 +datum=WGS84"))
extent_latlong = sp::SpatialPoints(rbind(bottom_left, top_right),
proj4string=sp::CRS("+proj=longlat +ellps=WGS84 +datum=WGS84"))
attr(elmat, "extent") = extent_latlong
attr(elmat, "crs") = raster::crs(elev_img)
attr(elmat, "rayshader_data") = TRUE
shape_watershed = sf::st_crop(shape_watershed, attr(elev_img,"extent"))
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,
attr(elmat,"extent"), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,
extent = raster::extent(elev_img), heightmap = elmat))  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7, linecolor = "blue")  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue", fillcolor = "none",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue", fill = "none",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.1)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.3)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.5)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(sunangle = 315, texture = "bw") %>%
add_overlay(generate_polygon_overlay(shape_watershed,  linecolor = "blue",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7)  %>%
#add_water(detect_water(elmat),color="imhof3") %>%
plot_map()
elmat %>%
sphere_shade(texture = "imhof4") %>%
#add_water(detect_water(elmat), color = "blue") %>%
add_shadow(ray_shade(elmat, zscale = 3), 0.5) %>%
add_shadow(ambient_shade(elmat), 0) %>%
add_overlay(generate_polygon_overlay(shape_watershed,
linecolor = "blue",
extent = raster::extent(elev_img), heightmap = elmat),
alphalayer=0.7)  %>%
plot_3d(elmat, zscale = 1, fov = 0, theta = -30, zoom = 0.75, phi = 45, windowsize = c(1000, 800))
Sys.sleep(0.2)
#render_depth(focus = 0.6, focallength = 10, clear = TRUE)
render_snapshot(clear=TRUE)
x_vec <- seq(1,100)
x_vec <- seq(1,100)
x_vec <- seq(1,100)
x_vec <- seq(1,100)
y_vec <- seq(1,100)
a <- seq(1,5)
rep(a,5)
rep(a,times = 5)
rep(a,each = 5)
y_mat <- rep(y_vec, each = 100)
x_mat <- rep(x_vec, times = 100)
library(tidyverse)
mat_coords <- as_tibble(x = x_mat, y = y_mat)
mat_coords <- tibble(x = x_mat, y = y_mat)
View(mat_coords)
volcano
a<-volcano
View(a)
a <- as.matrix(y_mat, nrow = 100, ncol = 1)
View(a)
a <- as.matrix(y_mat, nrow = 100, ncol = 100)
View(a)
a <- matrix(y_mat, nrow = 100, ncol = 100)
a <- matrix(y_mat, nrow = 100, ncol = 100, byrow = T)
mat_coords %>%
ggplot(aes(x = x, y = y, z = y)) +
geom_contour()
mat_coords %>%
ggplot(aes(x = x, y = y, z = y*x)) +
geom_contour()
library(tidyverse)
library(rayshader)
mat_coords %>%
ggplot(aes(x = x, y = y, z = y*x)) +
geom_contour_filled()
fig_1 <- mat_coords %>%
ggplot(aes(x = x, y = y, z = y*x)) +
geom_contour_filled()
fig_1
plot_gg(fig_1,multicore=TRUE,width=5,height=5,scale=250)
fig_1 <- mat_coords %>%
ggplot(aes(x = x, y = y, color = y*x)) +
geom_contour_filled()
fig_1
fig_1 <- mat_coords %>%
ggplot(aes(x = x, y = y, color = y*x)) +
geom_raster()
fig_1
fig_1 <- mat_coords %>%
ggplot(aes(x = x, y = y, fill = y*x)) +
geom_raster()
fig_1
plot_gg(fig_1,multicore=TRUE,width=5,height=5,scale=250)
mat_coords <- tibble(x = x_mat, y = y_mat, w1_dist = ((well_1_loc[1] - x)^2 + (well_1_loc[2] - y)^2)^0.5)
well_1_loc <- c(50, 50) # x and y coords
mat_coords <- tibble(x = x_mat, y = y_mat, w1_dist = ((well_1_loc[1] - x)^2 + (well_1_loc[2] - y)^2)^0.5)
((49^2)*2)^0.5
x_vec <- seq(0.5,y_length)
y_length <- 100
x_length <- y_length
x_vec <- seq(0.5,y_length)
x_vec
x_vec <- seq(0,y_length)
x_vec
